<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>True Love - Telegram Mini App</title>
    
    <!-- Telegram WebApp Script - ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž ÐŸÐ•Ð Ð’Ð«Ðœ -->
    <script src="https://telegram.org/js/telegram-web-app.js?58"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Ð´Ð»Ñ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        #root {
            height: 100vh;
            width: 100vw;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // ðŸ‘‡ Ð’Ð¡Ð¢ÐÐ’Ð¬Ð¢Ð• Ð’Ð•Ð¡Ð¬ Ð’ÐÐ¨ ÐšÐžÐ” Ð¡Ð®Ð”Ð, ÐÐž Ð‘Ð•Ð— Ð­Ð¢Ð˜Ð¥ Ð¡Ð¢Ð ÐžÐš:
        // âŒ Ð£Ð±ÐµÑ€Ð¸Ñ‚Ðµ: import React, { useState, useEffect, useCallback } from 'react';

// Telegram WebApp API integration
const getTelegramWebApp = () => {
  return window.Telegram?.WebApp;
};

// Ð’Ñ‹Ð½ÐµÑÐµÐ¼ ChatInput Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð·Ð° Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‹ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð°
const ChatInput = React.memo(({ matchId, onSendMessage }) => {
  const [message, setMessage] = useState('');
  
  const handleSend = useCallback(() => {
    const messageText = message.trim();
    console.log('ðŸ”„ ChatInput handleSend:', { matchId, message: messageText });
    
    if (messageText) {
      console.log('âœ… ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ:', messageText);
      onSendMessage(matchId, messageText);
      setMessage('');
      console.log('ðŸ§¹ ÐžÑ‡Ð¸Ñ‰ÐµÐ½ input');
    } else {
      console.log('âŒ ÐŸÑƒÑÑ‚Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, Ð½Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼');
    }
  }, [matchId, message, onSendMessage]);

  const handleKeyPress = useCallback((e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      handleSend();
    }
  }, [handleSend]);

  const handleChange = useCallback((e) => {
    setMessage(e.target.value);
  }, []);

  return (
    <div className="bg-white p-4 border-t border-gray-100">
      <div className="flex items-center space-x-2">
        <input
          type="text"
          value={message}
          onChange={handleChange}
          onKeyPress={handleKeyPress}
          placeholder="ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ..."
          className="flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:border-pink-500"
          autoComplete="off"
        />
        <button
          onClick={handleSend}
          className="p-2 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition-colors"
        >
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
          </svg>
        </button>
      </div>
    </div>
  );
});

// ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚
const DatingApp = () => {
  const [currentView, setCurrentView] = useState('discover');
  const [currentProfile, setCurrentProfile] = useState(0);

  // Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸
  const [isAuthenticated, setIsAuthenticated] = useState(false);
  const [authToken, setAuthToken] = useState(null);
  const [authError, setAuthError] = useState(null);
  const [userProfile, setUserProfile] = useState(null);

  // Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Telegram WebApp Ð¸ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
  useEffect(() => {
    const initializeApp = async () => {
      // Ð–Ð´ÐµÐ¼ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Telegram WebApp ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°
      let attempts = 0;
      const maxAttempts = 20;
      
      const waitForTelegram = () => {
        return new Promise((resolve) => {
          const checkTelegram = () => {
            attempts++;
            const tg = getTelegramWebApp();
            
            if (tg || attempts >= maxAttempts) {
              resolve(tg);
            } else {
              setTimeout(checkTelegram, 100);
            }
          };
          
          checkTelegram();
        });
      };
      
      console.log('ðŸ”„ ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Telegram WebApp...');
      const tg = await waitForTelegram();
      
      if (tg) {
        console.log('âœ… Telegram WebApp Ð½Ð°Ð¹Ð´ÐµÐ½');
        console.log('ðŸ” ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ° Telegram Ð¾Ð±ÑŠÐµÐºÑ‚Ð°:');
        console.log('- window.Telegram:', window.Telegram);
        console.log('- WebApp Ð¾Ð±ÑŠÐµÐºÑ‚:', tg);
        console.log('- initData:', tg.initData);
        console.log('- initDataUnsafe:', tg.initDataUnsafe);
        console.log('- platform:', tg.platform);
        console.log('- version:', tg.version);
        console.log('- user Ð´Ð°Ð½Ð½Ñ‹Ðµ:', tg.initDataUnsafe?.user);
        
        try {
          tg.ready();
          tg.expand();
          
          // ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ñ‚ÐµÐ¼Ñ‹
          if (tg.setHeaderColor) tg.setHeaderColor('#FF69B4');
          if (tg.setBackgroundColor) tg.setBackgroundColor('#FFFFFF');
          
          // ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð²ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐ²Ð°Ð¹Ð¿Ñ‹ Ð´Ð»Ñ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ
          if (tg.disableVerticalSwipes) tg.disableVerticalSwipes();
          
          // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸
          if (tg.MainButton) {
            tg.MainButton.setText('ÐÐ°Ð¹Ñ‚Ð¸ Ð¿Ð°Ñ€Ñƒ');
            tg.MainButton.color = '#FF69B4';
            tg.MainButton.textColor = '#FFFFFF';
          }
          
          console.log('âœ… Telegram WebApp Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½');
          
          // Ð”Ð•Ð¢ÐÐ›Ð¬ÐÐÐ¯ ÐžÐ¢Ð›ÐÐ”ÐšÐ ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð•Ð›Ð¯
          if (tg.initDataUnsafe?.user) {
            console.log('ðŸŽ‰ Ð Ð•ÐÐ›Ð¬ÐÐ«Ð™ ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð•Ð›Ð¬ ÐÐÐ™Ð”Ð•Ð:');
            console.log('- ID:', tg.initDataUnsafe.user.id);
            console.log('- Ð˜Ð¼Ñ:', tg.initDataUnsafe.user.first_name);
            console.log('- Ð¤Ð°Ð¼Ð¸Ð»Ð¸Ñ:', tg.initDataUnsafe.user.last_name);
            console.log('- Username:', tg.initDataUnsafe.user.username);
            console.log('- Ð¯Ð·Ñ‹Ðº:', tg.initDataUnsafe.user.language_code);
            console.log('- Premium:', tg.initDataUnsafe.user.is_premium);
          } else {
            console.log('âŒ ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð•Ð›Ð¬ ÐÐ• ÐÐÐ™Ð”Ð•Ð Ð² initDataUnsafe');
            console.log('ðŸ” Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ñ‹:');
            console.log('1. ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¾ Ð½Ðµ Ñ‡ÐµÑ€ÐµÐ· Telegram Ð±Ð¾Ñ‚Ð°');
            console.log('2. ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½ Web App Ð² BotFather'); 
            console.log('3. ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð´Ð¾Ð¼ÐµÐ½Ð¾Ð¼ Ð¸Ð»Ð¸ HTTPS');
          }
          
        } catch (error) {
          console.log('âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Telegram WebApp:', error);
        }
        
        // ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
        await authenticateUser(tg);
      } else {
        console.log('âš ï¸ Telegram WebApp Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ fallback');
        await authenticateUser(null);
      }
    };

    initializeApp();
  }, []);

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ñ‡ÐµÑ€ÐµÐ· Ð±ÑÐºÐµÐ½Ð´
  const authenticateUser = async (tg) => {
    try {
      console.log('ðŸ” ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ...');

      // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ initData Ð¸Ð· Telegram SDK
      let initDataRaw = '';
      
      try {
        const { retrieveRawInitData } = await import('@telegram-apps/sdk');
        initDataRaw = retrieveRawInitData();
        console.log('ðŸ“± Raw init data Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹ Ð¸Ð· SDK');
      } catch (sdkError) {
        console.log('âš ï¸ SDK Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½, Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ initData Ð¸Ð· WebApp API');
        // Fallback: Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¸Ð· WebApp API
        if (tg && tg.initData) {
          initDataRaw = tg.initData;
        } else {
          throw new Error('InitData Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹');
        }
      }

      if (!initDataRaw) {
        throw new Error('ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ initData');
      }

      console.log('ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€...');

      // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸
      const response = await fetch('/api/auth', {
        method: 'POST',
        headers: {
          'Authorization': `tma ${initDataRaw}`,
          'Content-Type': 'application/json'
        }
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({ error: 'ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°' }));
        throw new Error(errorData.error || `HTTP ${response.status}`);
      }

      const userData = await response.json();
      console.log('âœ… ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½:', userData);

      // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
      setIsAuthenticated(true);
      setUserProfile(userData);
      setAuthError(null);

      // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚Ð¾ÐºÐµÐ½ Ð´Ð»Ñ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÐ¸Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² (ÐµÑÐ»Ð¸ ÑÐµÑ€Ð²ÐµÑ€ ÐµÐ³Ð¾ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚)
      if (userData.token) {
        setAuthToken(userData.token);
        localStorage.setItem('authToken', userData.token);
      }

    } catch (error) {
      console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸:', error);
      setAuthError(error.message);
      setIsAuthenticated(false);

      // Fallback: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Telegram Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
      if (tg && tg.initDataUnsafe?.user) {
        console.log('ðŸ”„ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ fallback Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸');
        const fallbackUser = {
          id: tg.initDataUnsafe.user.id,
          first_name: tg.initDataUnsafe.user.first_name,
          last_name: tg.initDataUnsafe.user.last_name,
          username: tg.initDataUnsafe.user.username,
          language_code: tg.initDataUnsafe.user.language_code,
          is_premium: tg.initDataUnsafe.user.is_premium || false
        };
        
        setUserProfile(fallbackUser);
        setIsAuthenticated(true);
        setAuthError('Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ (Ð±ÐµÐ· Ð±ÑÐºÐµÐ½Ð´Ð°)');
      } else {
        // ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ fallback Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð±ÐµÐ· Telegram
        console.log('ðŸ”„ ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ fallback - ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ');
        const testUser = {
          id: Date.now(),
          first_name: 'ÐšÐ¸Ñ€Ð¸Ð»Ð»',
          last_name: 'Ð›ÑƒÐºÐ¸Ñ‡ÐµÐ²',
          username: 'kirill_test',
          language_code: 'ru',
          is_premium: false
        };
        
        setUserProfile(testUser);
        setIsAuthenticated(true);
        setAuthError('Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ (Ð±ÐµÐ· Telegram)');
      }
    }
  };
  // ÐšÐÐ Ð”Ð˜ÐÐÐ›Ð¬ÐÐžÐ• Ð Ð•Ð¨Ð•ÐÐ˜Ð•: useState + Ñ€ÑƒÑ‡Ð½Ð¾Ðµ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ localStorage
  const [likedProfiles, setLikedProfiles] = useState(() => {
    try {
      const saved = localStorage.getItem('likedProfiles');
      return saved ? JSON.parse(saved) : [];
    } catch {
      return [];
    }
  });
  
  const [matches, setMatches] = useState(() => {
    try {
      const saved = localStorage.getItem('matches');
      return saved ? JSON.parse(saved) : [];
    } catch {
      return [];
    }
  });
  const [selectedMatch, setSelectedMatch] = useState(null);
  const [chatMessages, setChatMessages] = useState({}); // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ useStoredState - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ useState
  const [currentPhotoIndex, setCurrentPhotoIndex] = useState(0);
  const [forceUpdate, setForceUpdate] = useState(0);
  const [deletingChat, setDeletingChat] = useState(null);
  
  // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ ref - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ

  
  // Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð»Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
  const [messageUpdate, setMessageUpdate] = useState(0); // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ useStoredState
  
  // Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾ÐºÐ½Ð° ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ
  const [showFullScreenMatch, setShowFullScreenMatch] = useState(null);
  const [matchPhotoIndex, setMatchPhotoIndex] = useState(0);
  
  // Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ¸
  const [showProfileView, setShowProfileView] = useState(null);
  const [profilePhotoIndex, setProfilePhotoIndex] = useState(0);
  
  // Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð»Ñ Ð·Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÐ²Ð°Ð¹Ð¿Ð°
  const [isDragging, setIsDragging] = useState(false);
  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });
  const [startPos, setStartPos] = useState({ x: 0, y: 0 });
  const [dragDistance, setDragDistance] = useState(0);
  const [isClick, setIsClick] = useState(false);
  const [isHolding, setIsHolding] = useState(false);

  // ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¸Ð· Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
  const currentUser = userProfile ? {
    name: userProfile.first_name || "ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ",
    telegramId: userProfile.id,
    username: userProfile.username,
    firstName: userProfile.first_name,
    lastName: userProfile.last_name,
    languageCode: userProfile.language_code,
    isPremium: userProfile.is_premium || false,
    age: 28, // Ð‘ÑƒÐ´ÐµÑ‚ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼
    bio: "Frontend Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº, Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¸Ðº, Ð»ÑŽÐ±Ð¸Ñ‚ÐµÐ»ÑŒ ÐºÐ¾Ñ„Ðµ Ð¸ Ñ…Ð¾Ñ€Ð¾ÑˆÐµÐ¹ Ð¼ÑƒÐ·Ñ‹ÐºÐ¸",
    interests: ["ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ", "ÐŸÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ñ", "ÐšÐ¾Ñ„Ðµ", "ÐœÑƒÐ·Ñ‹ÐºÐ°", "Ð¡Ð¿Ð¾Ñ€Ñ‚"],
    photos: [
      "keys/user_photo1?prompt=Young%20professional%20man%20portrait%20casual%20style",
      "keys/user_photo2?prompt=Man%20working%20on%20laptop%20modern%20office",
      "keys/user_photo3?prompt=Man%20traveling%20mountain%20landscape"
    ]
  } : null;

  // Ð”ÐµÐ¼Ð¾-Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ð¸ Ñ Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸ÐµÐ¹
  const profiles = [
    {
      id: 1,
      name: "Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°",
      age: 23,
      city: "ÐœÐ¾ÑÐºÐ²Ð°",
      distance: 2,
      bio: "Ð˜Ñ‰Ñƒ Ñ€Ð¾Ð´ÑÑ‚Ð²ÐµÐ½Ð½ÑƒÑŽ Ð´ÑƒÑˆÑƒ ðŸ’«",
      interests: ["ÐŸÑ€Ð°Ð²Ð¾ÑÐ»Ð°Ð²Ð¸Ðµ", "Ð Ñ‹Ð±Ñ‹", "162ÑÐ¼", "Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ", "ÐÐµÑ‚", "ÐÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾"],
      photos: [
        "keys/ekaterina_1?prompt=Beautiful%20young%20brunette%20woman%2023%20years%20old%20elegant%20portrait%20natural%20makeup%20soft%20lighting",
        "keys/ekaterina_2?prompt=Young%20brunette%20woman%20in%20orthodox%20church%20praying%20peaceful%20spiritual%20atmosphere",
        "keys/ekaterina_3?prompt=Portrait%20young%20woman%20reading%20book%20cozy%20cafe%20intellectual%20style",
        "keys/ekaterina_4?prompt=Young%20woman%20in%20nature%20park%20casual%20dress%20gentle%20smile%20golden%20hour"
      ],
      job: "Ð”Ð¸Ð·Ð°Ð¹Ð½ÐµÑ€",
      education: "ÐœÐ“Ð£",
      height: "162 ÑÐ¼"
    },
    {
      id: 2,
      name: "ÐÐ½Ð½Ð°",
      age: 25,
      city: "ÐœÐ¾ÑÐºÐ²Ð°", 
      distance: 5,
      bio: "Ð›ÑŽÐ±Ð»ÑŽ Ð¶Ð¸Ð·Ð½ÑŒ Ð²Ð¾ Ð²ÑÐµÑ… ÐµÑ‘ Ð¿Ñ€Ð¾ÑÐ²Ð»ÐµÐ½Ð¸ÑÑ… âœ¨",
      interests: ["Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ", "Ð™Ð¾Ð³Ð°", "ÐŸÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ñ", "ÐœÐ¾Ð´Ð°", "Ð˜ÑÐºÑƒÑÑÑ‚Ð²Ð¾"],
      photos: [
        "keys/anna_1?prompt=Beautiful%20young%20blonde%20woman%2025%20years%20old%20bohemian%20style%20photographer%20creative%20portrait",
        "keys/anna_2?prompt=Young%20blonde%20woman%20doing%20yoga%20pose%20peaceful%20studio%20athletic%20wear",
        "keys/anna_3?prompt=Young%20woman%20traveling%20mountain%20landscape%20backpack%20adventure%20style",
        "keys/anna_4?prompt=Portrait%20young%20woman%20fashion%20photography%20artistic%20lighting%20modern%20style"
      ],
      job: "Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„",
      education: "Ð¨ÐºÐ¾Ð»Ð° Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸",
      height: "165 ÑÐ¼"
    },
    {
      id: 3,
      name: "ÐœÐ°Ñ€Ð¸Ñ",
      age: 26,
      city: "ÐœÐ¾ÑÐºÐ²Ð°",
      distance: 12,
      bio: "Ð¢Ð²Ð¾Ñ€Ñ‡ÐµÑÐºÐ°Ñ Ð½Ð°Ñ‚ÑƒÑ€Ð° Ð² Ð¿Ð¾Ð¸ÑÐºÐ°Ñ… Ð²Ð´Ð¾Ñ…Ð½Ð¾Ð²ÐµÐ½Ð¸Ñ ðŸŽ¨",
      interests: ["Ð˜ÑÐºÑƒÑÑÑ‚Ð²Ð¾", "Ð”Ð¸Ð·Ð°Ð¹Ð½", "ÐšÐ¸Ð½Ð¾", "Ð–Ð¸Ð²Ð¾Ð¿Ð¸ÑÑŒ", "ÐœÑƒÐ·Ñ‹ÐºÐ°"],
      photos: [
        "keys/maria_1?prompt=Beautiful%20young%20redhead%20woman%2026%20years%20old%20artistic%20creative%20style%20warm%20lighting",
        "keys/maria_2?prompt=Young%20redhead%20woman%20in%20art%20studio%20painting%20canvas%20creative%20workspace",
        "keys/maria_3?prompt=Creative%20young%20woman%20graphic%20design%20workspace%20modern%20office%20artistic",
        "keys/maria_4?prompt=Portrait%20young%20artist%20woman%20gallery%20setting%20sophisticated%20artistic%20atmosphere"
      ],
      job: "Ð¥ÑƒÐ´Ð¾Ð¶Ð½Ð¸Ñ†Ð°",
      education: "Ð¥ÑƒÐ´Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ Ð°ÐºÐ°Ð´ÐµÐ¼Ð¸Ñ",
      height: "168 ÑÐ¼"
    }
  ];

  // ÐŸÑ€Ð¾ÑÑ‚Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð±ÐµÐ· localStorage
  const sendMessage = useCallback(async (matchId, message) => {
    console.log('ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ:', { matchId, message });
    
    if (!message.trim()) {
      console.log('âŒ ÐŸÑƒÑÑ‚Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, Ð¾Ñ‚Ð¼ÐµÐ½Ð°');
      return;
    }
    
    const userMessage = message.trim();
    const newMsg = {
      id: Date.now(),
      text: userMessage,
      sender: 'user',
      timestamp: new Date().toISOString()
    };
    
    console.log('ðŸ“ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ:', newMsg);
    
    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
    setChatMessages(prev => {
      const existingMessages = prev[matchId] || [];
      const updatedMessages = [...existingMessages, newMsg];
      
      const updated = {
        ...prev,
        [matchId]: updatedMessages
      };
      
      console.log('ðŸ’¾ Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ. Ð‘Ñ‹Ð»Ð¾:', existingMessages.length, 'Ð¡Ñ‚Ð°Ð»Ð¾:', updatedMessages.length);
      return updated;
    });
    
    // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ¸
    setMessageUpdate(prev => prev + 1);
    setForceUpdate(prev => prev + 1);
    
    // ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€
    try {
      await makeAuthenticatedRequest('/api/messages', {
        method: 'POST',
        body: JSON.stringify({
          recipientId: matchId,
          message: userMessage,
          timestamp: new Date().toISOString()
        })
      });
      console.log('âœ… Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€');
      
      // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÑŽ
      await sendNotification(matchId, userMessage);
      
    } catch (error) {
      console.log('âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€:', error);
      // ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÐ¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð² Ð¾Ñ„Ñ„Ð»Ð°Ð¹Ð½ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ
    }

    // ÐÐ²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚ Ñ‡ÐµÑ€ÐµÐ· 2 ÑÐµÐºÑƒÐ½Ð´Ñ‹ (Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾)
    const match = profiles.find(p => p.id === matchId);
    setTimeout(() => {
      console.log('ðŸ¤– ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð´Ð»Ñ:', userMessage);
      
      // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚
      setChatMessages(currentChatMessages => {
        const currentMessages = currentChatMessages[matchId] || [];
        console.log('ðŸ” Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚Ð°:', currentMessages.length);
        
        // Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ Ð¾Ñ‚Ð²ÐµÑ‚ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸
        const smartResponse = generateSmartResponse(userMessage, currentMessages, match);
        
        const autoReply = {
          id: Date.now() + Math.random(),
          text: smartResponse,
          sender: 'match',
          timestamp: new Date().toISOString()
        };
        
        console.log('ðŸ¤– Ð¡Ð¾Ð·Ð´Ð°Ð½ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚:', autoReply.text);
        
        // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚ Ðº Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÐ¼
        const finalMessages = [...currentMessages, autoReply];
        
        const updated = {
          ...currentChatMessages,
          [matchId]: finalMessages
        };
        
        console.log('ðŸ’¾ Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚. Ð˜Ñ‚Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹:', finalMessages.length);
        console.log('ðŸ“Š Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°: Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ =', finalMessages.filter(m => m.sender === 'user').length, 'Ð´ÐµÐ²ÑƒÑˆÐºÐ° =', finalMessages.filter(m => m.sender === 'match').length);
        
        return updated;
      });
      
      // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ¸
      setMessageUpdate(prev => prev + 1);
      setForceUpdate(prev => prev + 1);
      
    }, 2000);
  }, []);

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ ÑƒÐ¼Ð½Ñ‹Ñ… Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð²
  const generateSmartResponse = (userMessage, messageHistory, match) => {
    const msg = userMessage.toLowerCase();
    const isFirstMessage = messageHistory.length <= 1;
    
    // ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð´Ð»Ñ Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ñ‚Ð¸Ð¿Ð¾Ð² ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
    const patterns = {
      greeting: ['Ð¿Ñ€Ð¸Ð²ÐµÑ‚', 'Ð·Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹', 'Ð´Ð¾Ð±Ñ€Ð¾ ÑƒÑ‚Ñ€Ð¾', 'Ð´Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ', 'Ð´Ð¾Ð±Ñ€Ñ‹Ð¹ Ð²ÐµÑ‡ÐµÑ€', 'Ñ…Ð°Ð¹', 'Ð¿Ñ€Ð¸Ð²ÐµÑ‚Ð¸Ðº'],
      questions: ['ÐºÐ°Ðº Ð´ÐµÐ»Ð°', 'Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑˆÑŒ', 'ÐºÐ°Ðº Ð¶Ð¸Ð·Ð½ÑŒ', 'Ñ‡Ñ‚Ð¾ Ð½Ð¾Ð²Ð¾Ð³Ð¾', 'ÐºÐ°Ðº Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ'],
      compliments: ['ÐºÑ€Ð°ÑÐ¸Ð²Ð°Ñ', 'Ð¿Ñ€ÐµÐºÑ€Ð°ÑÐ½Ð°Ñ', 'ÐºÑ€Ð°ÑÐ¾Ñ‚Ð°', 'Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»Ð°ÑÑŒ', 'ÑÐ¸Ð¼Ð¿Ð°Ñ‚Ð¸Ñ‡Ð½Ð°Ñ'],
      interests: ['Ñ…Ð¾Ð±Ð±Ð¸', 'ÑƒÐ²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ', 'Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑ‹', 'ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ', 'Ð»ÑŽÐ±Ð¸ÑˆÑŒ'],
      work: ['Ñ€Ð°Ð±Ð¾Ñ‚Ð°', 'Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ñ', 'ÐºÐ°Ñ€ÑŒÐµÑ€Ð°', 'Ð´ÐµÐ»Ð°', 'Ñ‚Ñ€ÑƒÐ´'],
      weekend: ['Ð²Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ðµ', 'ÑÑƒÐ±Ð±Ð¾Ñ‚Ð°', 'Ð²Ð¾ÑÐºÑ€ÐµÑÐµÐ½ÑŒÐµ', 'Ð¿Ð»Ð°Ð½Ñ‹', 'Ð¾Ñ‚Ð´Ñ‹Ñ…'],
      meeting: ['Ð²ÑÑ‚Ñ€ÐµÑ‡Ð°', 'Ð²ÑÑ‚Ñ€ÐµÑ‚Ð¸Ñ‚ÑŒÑÑ', 'ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒÑÑ', 'ÑÐ²Ð¸Ð´Ð°Ð½Ð¸Ðµ', 'ÐºÐ¾Ñ„Ðµ', 'Ð¿Ð¾Ð³ÑƒÐ»ÑÑ‚ÑŒ'],
      travel: ['Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ðµ', 'Ð¿Ð¾ÐµÐ·Ð´ÐºÐ°', 'Ð¾Ñ‚Ð¿ÑƒÑÐº', 'ÑÑ‚Ñ€Ð°Ð½Ð°', 'Ð³Ð¾Ñ€Ð¾Ð´']
    };
    
    // ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ñ‚Ð¸Ð¿ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
    let responseType = 'general';
    for (const [type, words] of Object.entries(patterns)) {
      if (words.some(word => msg.includes(word))) {
        responseType = type;
        break;
      }
    }
    
    // Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ Ð¾Ñ‚Ð²ÐµÑ‚ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¸Ð¿Ð° Ð¸ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð°
    let responses = [];
    
    if (isFirstMessage) {
      responses = [
        `ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐžÑ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾ Ð¿Ð¾Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¸Ñ‚ÑŒÑÑ! ðŸ˜Š`,
        `ÐŸÑ€Ð¸Ð²ÐµÑ‚! Ð Ð°Ð´Ð°, Ñ‡Ñ‚Ð¾ Ð¼Ñ‹ ÑÐ¾Ð²Ð¿Ð°Ð»Ð¸! âœ¨`,
        `ÐŸÑ€Ð¸Ð²ÐµÑ‚Ð¸Ðº! Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ð»Ð°Ð¹Ðº, Ñ‚Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ñ‚Ð¾Ð¶Ðµ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»ÑÑ! ðŸ’•`,
        `Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹! ÐšÐ°Ðº Ð´ÐµÐ»Ð°? ðŸ˜Š`
      ];
    } else {
      switch (responseType) {
        case 'greeting':
          responses = [
            `ÐŸÑ€Ð¸Ð²ÐµÑ‚! Ð¥Ð¾Ñ€Ð¾ÑˆÐ¾, Ñ‡Ñ‚Ð¾ Ð¿Ð¸ÑˆÐµÑˆÑŒ! ðŸ˜Š`,
            `ÐŸÑ€Ð¸Ð²ÐµÑ‚Ð¸Ðº! Ð Ð°Ð´Ð° Ñ‚ÐµÐ±Ñ Ð²Ð¸Ð´ÐµÑ‚ÑŒ! âœ¨`,
            `Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹! ÐšÐ°Ðº Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ? ðŸ˜Š`
          ];
          break;
          
        case 'questions':
          responses = [
            `ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾! Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ñ‡Ñ‚Ð¾ ${match.name === 'Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°' ? 'Ð¸Ð· Ñ†ÐµÑ€ÐºÐ²Ð¸ Ð²ÐµÑ€Ð½ÑƒÐ»Ð°ÑÑŒ' : match.name === 'ÐÐ½Ð½Ð°' ? 'Ñ Ð¹Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸ÑˆÐ»Ð°' : 'Ñ€Ð¸ÑÐ¾Ð²Ð°Ð»Ð°'} ðŸ˜Š Ð Ñƒ Ñ‚ÐµÐ±Ñ ÐºÐ°Ðº Ð´ÐµÐ»Ð°?`,
            `Ð¥Ð¾Ñ€Ð¾ÑˆÐ¾! Ð Ð°Ð±Ð¾Ñ‚Ð°ÑŽ ${match.job === 'Ð”Ð¸Ð·Ð°Ð¹Ð½ÐµÑ€' ? 'Ð½Ð°Ð´ Ð½Ð¾Ð²Ñ‹Ð¼ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð¼' : match.job === 'Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„' ? 'Ð½Ð°Ð´ Ñ„Ð¾Ñ‚Ð¾ÑÐµÑÑÐ¸ÐµÐ¹' : 'Ð½Ð°Ð´ ÐºÐ°Ñ€Ñ‚Ð¸Ð½Ð¾Ð¹'} ðŸŽ¨ ÐšÐ°Ðº Ñ‚Ð²Ð¾Ð¸ Ð´ÐµÐ»Ð°?`,
            `Ð—Ð°Ð¼ÐµÑ‡Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾! Ð”ÑƒÐ¼Ð°ÑŽ Ð¾ ${match.interests[0].toLowerCase()} ðŸ˜Š Ð Ñ‡Ñ‚Ð¾ Ñƒ Ñ‚ÐµÐ±Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾?`
          ];
          break;
          
        case 'compliments':
          responses = [
            `Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾! ÐžÑ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾! ðŸ˜Š Ð¢Ñ‹ Ñ‚Ð¾Ð¶Ðµ ÑÐ¸Ð¼Ð¿Ð°Ñ‚Ð¸Ñ‡Ð½Ñ‹Ð¹!`,
            `ÐžÐ¹, ÑÐ¿Ð°ÑÐ¸Ð±Ð¾! Ð¡Ð¼ÑƒÑ‰Ð°ÐµÑˆÑŒ Ð¼ÐµÐ½Ñ! ðŸ˜Šâœ¨`,
            `Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ! ÐœÐ½Ðµ Ñ‚Ð¾Ð¶Ðµ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»ÑÑ Ñ‚Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ! ðŸ’•`
          ];
          break;
          
        case 'interests':
          const mainInterest = match.interests[0];
          responses = [
            `ÐžÑ‡ÐµÐ½ÑŒ Ð»ÑŽÐ±Ð»ÑŽ ${mainInterest.toLowerCase()}! ${match.name === 'Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°' ? 'Ð­Ñ‚Ð¾ Ð´Ð°ÐµÑ‚ Ð¼Ð½Ðµ ÑƒÐ¼Ð¸Ñ€Ð¾Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸Ðµ' : match.name === 'ÐÐ½Ð½Ð°' ? 'ÐŸÐ¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð½Ð°Ð¹Ñ‚Ð¸ Ð±Ð°Ð»Ð°Ð½Ñ' : 'Ð­Ñ‚Ð¾ Ð¼Ð¾Ñ ÑÑ‚Ñ€Ð°ÑÑ‚ÑŒ!'} ðŸ˜Š Ð Ñ‚Ñ‹ Ñ‡ÐµÐ¼ ÑƒÐ²Ð»ÐµÐºÐ°ÐµÑˆÑŒÑÑ?`,
            `ÐœÐ¾Ð¸ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑ‹ - ${match.interests.slice(0, 2).map(i => i.toLowerCase()).join(' Ð¸ ')} ðŸŽ¨ Ð Ñ‡Ñ‚Ð¾ Ñ‚ÐµÐ±Ðµ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ?`,
            `ÐžÐ±Ð¾Ð¶Ð°ÑŽ ${mainInterest.toLowerCase()}! Ð Ñƒ Ñ‚ÐµÐ±Ñ ÐµÑÑ‚ÑŒ Ñ…Ð¾Ð±Ð±Ð¸? ðŸ˜Š`
          ];
          break;
          
        case 'work':
          responses = [
            `Ð Ð°Ð±Ð¾Ñ‚Ð°ÑŽ ${match.job === 'Ð”Ð¸Ð·Ð°Ð¹Ð½ÐµÑ€' ? 'Ð´Ð¸Ð·Ð°Ð¹Ð½ÐµÑ€Ð¾Ð¼ - ÑÐ¾Ð·Ð´Ð°ÑŽ ÐºÑ€Ð°ÑÐ¾Ñ‚Ñƒ' : match.job === 'Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„' ? 'Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¾Ð¼ - Ð»Ð¾Ð²Ð»ÑŽ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ñ‹' : 'Ñ…ÑƒÐ´Ð¾Ð¶Ð½Ð¸Ñ†ÐµÐ¹ - Ñ€Ð¸ÑÑƒÑŽ Ð¼Ð¸Ñ€'} ðŸŽ¨ Ð Ñ‚Ñ‹ Ñ‡ÐµÐ¼ Ð·Ð°Ð½Ð¸Ð¼Ð°ÐµÑˆÑŒÑÑ?`,
            `ÐœÐ¾Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð° - ${match.job.toLowerCase()}, Ð¾Ñ‡ÐµÐ½ÑŒ Ð»ÑŽÐ±Ð»ÑŽ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÑŽ! ðŸ˜Š Ð Ñ‚Ð²Ð¾Ñ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ñ?`,
            `${match.job} - ÑÑ‚Ð¾ Ð¼Ð¾Ñ ÑÑ‚Ñ€Ð°ÑÑ‚ÑŒ! ðŸ’• Ð Ð°ÑÑÐºÐ°Ð¶Ð¸ Ð¾ ÑÐ²Ð¾ÐµÐ¹ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ!`
          ];
          break;
          
        case 'weekend':
          responses = [
            `ÐŸÐ»Ð°Ð½Ð¸Ñ€ÑƒÑŽ ${match.name === 'Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°' ? 'ÑÑ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð² Ñ†ÐµÑ€ÐºÐ¾Ð²ÑŒ Ð¸ Ð¿Ð¾Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ' : match.name === 'ÐÐ½Ð½Ð°' ? 'Ð¹Ð¾Ð³Ñƒ Ð¸ Ñ„Ð¾Ñ‚Ð¾Ð¿Ñ€Ð¾Ð³ÑƒÐ»ÐºÑƒ' : 'Ñ€Ð¸ÑÐ¾Ð²Ð°Ñ‚ÑŒ Ð¸ ÑÑ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð² Ð³Ð°Ð»ÐµÑ€ÐµÑŽ'} ðŸ˜Š Ð Ñ‚Ð²Ð¾Ð¸ Ð¿Ð»Ð°Ð½Ñ‹?`,
            `Ð¥Ð¾Ñ‡Ñƒ Ð·Ð°Ð½ÑÑ‚ÑŒÑÑ ${match.interests[0].toLowerCase()} Ð¸ Ð¾Ñ‚Ð´Ð¾Ñ…Ð½ÑƒÑ‚ÑŒ! Ð Ñ‚Ñ‹ ÐºÐ°Ðº Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð¸ÑˆÑŒ Ð²Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ðµ? ðŸŽ‰`,
            `Ð”ÑƒÐ¼Ð°ÑŽ Ð¿Ð¾ÑÐ²ÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ñ€ÐµÐ¼Ñ ${match.interests[0].toLowerCase()} ðŸ˜Š Ð Ñƒ Ñ‚ÐµÐ±Ñ ÐµÑÑ‚ÑŒ Ð¿Ð»Ð°Ð½Ñ‹?`
          ];
          break;
          
        case 'meeting':
          responses = [
            `Ð‘Ñ‹Ð»Ð¾ Ð±Ñ‹ Ð·Ð´Ð¾Ñ€Ð¾Ð²Ð¾ Ð²ÑÑ‚Ñ€ÐµÑ‚Ð¸Ñ‚ÑŒÑÑ! â˜• ÐœÐ¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ, ${match.name === 'Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°' ? 'Ð¿Ñ€Ð¾Ð³ÑƒÐ»ÑÐµÐ¼ÑÑ Ð¿Ð¾ Ð¿Ð°Ñ€ÐºÑƒ' : match.name === 'ÐÐ½Ð½Ð°' ? 'ÑÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð²Ñ‹ÑÑ‚Ð°Ð²ÐºÑƒ' : 'Ð¿Ð¾ÑÐµÑ‚Ð¸Ð¼ Ð°Ñ€Ñ‚-Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾'}? ðŸ˜Š`,
            `ÐœÐ½Ðµ Ñ‚Ð¾Ð¶Ðµ Ñ…Ð¾Ñ‚ÐµÐ»Ð¾ÑÑŒ Ð±Ñ‹ Ð²ÑÑ‚Ñ€ÐµÑ‚Ð¸Ñ‚ÑŒÑÑ! ðŸ’• Ð“Ð´Ðµ Ð»ÑŽÐ±Ð¸ÑˆÑŒ Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð²Ñ€ÐµÐ¼Ñ?`,
            `ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð°Ñ Ð¸Ð´ÐµÑ! ${match.name === 'Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°' ? 'ÐœÐ¾Ð¶ÐµÑ‚, Ð² ÑƒÑŽÑ‚Ð½Ð¾Ð¼ ÐºÐ°Ñ„Ðµ?' : match.name === 'ÐÐ½Ð½Ð°' ? 'ÐœÐ¾Ð¶ÐµÑ‚, Ð½Ð° Ð¿Ñ€Ð¸Ñ€Ð¾Ð´Ðµ?' : 'Ð’ ÐºÐ°ÐºÐ¾Ð¼-Ñ‚Ð¾ Ñ‚Ð²Ð¾Ñ€Ñ‡ÐµÑÐºÐ¾Ð¼ Ð¼ÐµÑÑ‚Ðµ?'} âœ¨`
          ];
          break;
          
        case 'travel':
          responses = [
            `ÐžÐ±Ð¾Ð¶Ð°ÑŽ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ñ! ${match.name === 'ÐÐ½Ð½Ð°' ? 'ÐÐµÐ´Ð°Ð²Ð½Ð¾ Ð±Ñ‹Ð»Ð° Ð² Ð³Ð¾Ñ€Ð°Ñ… - Ð¿Ð¾Ñ‚Ñ€ÑÑÐ°ÑŽÑ‰Ð¸Ðµ Ð²Ð¸Ð´Ñ‹!' : 'ÐœÐµÑ‡Ñ‚Ð°ÑŽ Ð¿Ð¾ÑÐµÑ‚Ð¸Ñ‚ÑŒ Ð•Ð²Ñ€Ð¾Ð¿Ñƒ'} ðŸ—ºï¸ Ð Ñ‚Ñ‹ ÐºÑƒÐ´Ð° Ð»ÑŽÐ±Ð¸ÑˆÑŒ ÐµÐ·Ð´Ð¸Ñ‚ÑŒ?`,
            `ÐŸÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ñ - ÑÑ‚Ð¾ Ñ‚Ð°Ðº Ð²Ð´Ð¾Ñ…Ð½Ð¾Ð²Ð»ÑÐµÑ‚! ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ Ð´Ð»Ñ ${match.job.toLowerCase()} ðŸ˜Š ÐšÐ°ÐºÐ¸Ðµ ÑÑ‚Ñ€Ð°Ð½Ñ‹ Ñ‚ÐµÐ±Ðµ Ð½Ñ€Ð°Ð²ÑÑ‚ÑÑ?`,
            `Ð”Ð°, Ð»ÑŽÐ±Ð»ÑŽ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ð¼ÐµÑÑ‚Ð°! Ð Ñ‚Ñ‹ Ñ‡Ð°ÑÑ‚Ð¾ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²ÑƒÐµÑˆÑŒ? âœˆï¸`
          ];
          break;
          
        default:
          responses = [
            `Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾! Ð Ð°ÑÑÐºÐ°Ð¶Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ ðŸ˜Š`,
            `ÐŸÐ¾Ð½Ð¸Ð¼Ð°ÑŽ Ñ‚ÐµÐ±Ñ! ${match.name === 'Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°' ? 'Ð¯ Ñ‚Ð¾Ð¶Ðµ Ð¸Ð½Ð¾Ð³Ð´Ð° Ñ‚Ð°Ðº Ð´ÑƒÐ¼Ð°ÑŽ' : match.name === 'ÐÐ½Ð½Ð°' ? 'ÐœÐ½Ðµ Ð±Ð»Ð¸Ð·ÐºÐ° ÑÑ‚Ð° Ñ‚ÐµÐ¼Ð°' : 'Ð—Ð²ÑƒÑ‡Ð¸Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‰Ðµ'} âœ¨`,
            `Ð¡Ð¾Ð³Ð»Ð°ÑÐ½Ð°! Ð ÐºÐ°Ðº Ñ‚Ñ‹ Ðº ÑÑ‚Ð¾Ð¼Ñƒ Ð¿Ñ€Ð¸ÑˆÐµÐ»? ðŸ¤”`,
            `ÐœÐ½Ðµ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ Ñ‚Ð²Ð¾Ð¹ Ð²Ð·Ð³Ð»ÑÐ´ Ð½Ð° Ð²ÐµÑ‰Ð¸! ðŸ’•`,
            `ÐšÐ»Ð°ÑÑÐ½Ð¾! ${match.interests[0]} Ñ‚Ð¾Ð¶Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑÐ²ÑÐ·Ð°Ð½Ð¾ Ñ ÑÑ‚Ð¸Ð¼ ðŸ˜Š`
          ];
      }
    }
    
    return responses[Math.floor(Math.random() * responses.length)];
  };

  // ÐŸÐ ÐžÐ¡Ð¢ÐÐ¯ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸ Ð²ÑÐµÑ… Ñ‡Ð°Ñ‚Ð¾Ð²
  const clearAllChats = useCallback(() => {
    console.log('ðŸ§¹ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð²ÑÐµÑ… Ñ‡Ð°Ñ‚Ð¾Ð²');
    
    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ Ð¼Ð¾Ð´Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾ÐºÐ½Ð°
    setSelectedMatch(null);
    setDeletingChat(null);
    setShowFullScreenMatch(null);
    setShowProfileView(null);
    
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð²ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ
    setMatches([]);
    setChatMessages({});
    setLikedProfiles([]);
    
    console.log('âœ… Ð’ÑÐµ Ñ‡Ð°Ñ‚Ñ‹ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ñ‹');
  }, []);

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… API Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²
  const makeAuthenticatedRequest = useCallback(async (url, options = {}) => {
    try {
      const headers = {
        'Content-Type': 'application/json',
        ...options.headers
      };

      // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ñ‚Ð¾ÐºÐµÐ½ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ
      if (authToken) {
        headers['Authorization'] = `Bearer ${authToken}`;
      } else {
        const tg = getTelegramWebApp();
        if (tg) {
          // ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð¾: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ initData Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°
          try {
            const { retrieveRawInitData } = await import('@telegram-apps/sdk');
            const initDataRaw = retrieveRawInitData();
            headers['Authorization'] = `tma ${initDataRaw}`;
          } catch (error) {
            console.log('âš ï¸ ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ initData Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°');
          }
        }
      }

      const response = await fetch(url, {
        ...options,
        headers
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({ error: 'ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°' }));
        throw new Error(errorData.error || `HTTP ${response.status}`);
      }

      return await response.json();
    } catch (error) {
      console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° API Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°:', error);
      throw error;
    }
  }, [authToken]);

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ
  const saveUserProfile = useCallback(async (profileData) => {
    try {
      console.log('ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ...');
      
      const result = await makeAuthenticatedRequest('/api/profile', {
        method: 'PUT',
        body: JSON.stringify(profileData)
      });

      console.log('âœ… ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ:', result);
      return result;
    } catch (error) {
      console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ:', error);
      // Fallback: ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾
      localStorage.setItem(`user_profile_${userProfile.id}`, JSON.stringify(profileData));
      throw error;
    }
  }, [makeAuthenticatedRequest, userProfile]);

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð°
  const fetchMatches = useCallback(async () => {
    try {
      console.log('ðŸ” ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð°...');
      
      const result = await makeAuthenticatedRequest('/api/matches');
      
      console.log('âœ… Ð¡Ð¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð°:', result);
      return result;
    } catch (error) {
      console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹:', error);
      // Fallback: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ
      return [];
    }
  }, [makeAuthenticatedRequest]);

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· ÑÐµÑ€Ð²ÐµÑ€
  const sendNotification = useCallback(async (recipientId, message) => {
    try {
      console.log('ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· ÑÐµÑ€Ð²ÐµÑ€...');
      
      const result = await makeAuthenticatedRequest('/api/notifications', {
        method: 'POST',
        body: JSON.stringify({
          recipientId,
          message,
          type: 'chat_message'
        })
      });

      console.log('âœ… Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ñ‡ÐµÑ€ÐµÐ· ÑÐµÑ€Ð²ÐµÑ€');
      return result;
    } catch (error) {
      console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ:', error);
      
      // Fallback: Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ñ‡ÐµÑ€ÐµÐ· WebApp API
      const tg = getTelegramWebApp();
      if (tg && tg.sendData) {
        tg.sendData(JSON.stringify({
          type: 'notification',
          recipientId,
          message,
          from: currentUser
        }));
        console.log('ðŸ“± Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ñ‡ÐµÑ€ÐµÐ· Telegram WebApp API');
      }
    }
  }, [makeAuthenticatedRequest, currentUser]);

  // ÐŸÐ ÐžÐ¡Ð¢ÐÐ¯ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‡Ð°Ñ‚Ð°
  const deleteChat = useCallback((matchId) => {
    console.log('ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‡Ð°Ñ‚Ð°:', matchId);
    
    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ñ‡Ð°Ñ‚ ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ Ð¾Ð½
    if (selectedMatch && selectedMatch.id === matchId) {
      setSelectedMatch(null);
    }
    
    // Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð¸Ð· Ð²ÑÐµÑ… ÑÐ¿Ð¸ÑÐºÐ¾Ð²
    setMatches(prev => prev.filter(match => match.id !== matchId));
    setLikedProfiles(prev => prev.filter(id => id !== matchId));
    setChatMessages(prev => {
      const updated = { ...prev };
      delete updated[matchId];
      return updated;
    });
    
    console.log('âœ… Ð§Ð°Ñ‚ ÑƒÐ´Ð°Ð»ÐµÐ½:', matchId);
  }, [selectedMatch]);

  const handleLike = () => {
    // Ð¥ÑÐ¿Ñ‚Ð¸Ðº Ñ„Ð¸Ð´Ð±ÐµÐº Ð´Ð»Ñ Telegram
    const tg = getTelegramWebApp();
    if (tg && tg.HapticFeedback) {
      tg.HapticFeedback.impactOccurred('light');
    }
    
    const profile = profiles[currentProfile];
    if (!likedProfiles.includes(profile.id)) {
      setLikedProfiles([...likedProfiles, profile.id]);
      
      // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ Ñ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒÑŽ (70%)
      if (Math.random() > 0.3) {
        const existingMatch = matches.find(m => m.id === profile.id);
        if (!existingMatch) {
          // ÐšÐ Ð˜Ð¢Ð˜Ð§ÐÐž: ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐž Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð»ÑŽÐ±ÑƒÑŽ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ
          setChatMessages(prevMessages => {
            console.log('ðŸ§¹ ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð´Ð»Ñ', profile.name, 'ID:', profile.id);
            console.log('ðŸ” Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ ÐºÐ»ÑŽÑ‡Ð¸ Ð² chatMessages:', Object.keys(prevMessages));
            console.log('ðŸ” Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð»Ð¸ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð´Ð»Ñ ID', profile.id, ':', !!prevMessages[profile.id]);
            
            if (prevMessages[profile.id]) {
              console.log('ðŸ—‘ï¸ ÐÐÐ™Ð”Ð•ÐÐ ÑÑ‚Ð°Ñ€Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ! Ð£Ð´Ð°Ð»ÑÐµÐ¼', (prevMessages[profile.id] || []).length, 'ÑÑ‚Ð°Ñ€Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹');
            }
            
            // Ð’Ð¡Ð•Ð“Ð”Ð ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚ Ð‘Ð•Ð— ÑÑ‚Ð¾Ð³Ð¾ ÐºÐ»ÑŽÑ‡Ð°
            const cleanMessages = {};
            Object.keys(prevMessages).forEach(key => {
              if (key !== profile.id.toString()) {
                cleanMessages[key] = prevMessages[key];
              }
            });
            
            console.log('âœ… Ð§Ð˜Ð¡Ð¢Ð«Ð• ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸:', Object.keys(cleanMessages));
            console.log('ðŸ”¥ Ð“ÐÐ ÐÐÐ¢Ð˜Ð¯: Ð´Ð»Ñ ID', profile.id, 'Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ ÐŸÐžÐ›ÐÐžÐ¡Ð¢Ð¬Ð® Ð£Ð”ÐÐ›Ð•ÐÐ');
            return cleanMessages;
          });
          
          // Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼
          setMatches(prevMatches => {
            const doubleCheck = prevMatches.find(m => m.id === profile.id);
            if (doubleCheck) {
              console.log('âš ï¸ Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¾ - ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚');
              return prevMatches;
            }
            
            const newMatches = [...prevMatches, profile];
            console.log('ðŸ’• Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ ÐÐžÐ’ÐžÐ• ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ Ñ Ð§Ð˜Ð¡Ð¢ÐžÐ™ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÐµÐ¹:', profile.name);
            console.log('ðŸ” ÐÐ¾Ð²Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº matches:', newMatches);
            console.log('ðŸ“Š DEBUG - Ð Ð°Ð·Ð¼ÐµÑ€ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ¿Ð¸ÑÐºÐ°:', newMatches.length);
            return newMatches;
          });
          
          // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
          setForceUpdate(prev => {
            const newValue = prev + 1;
            console.log('ðŸ”„ ForceUpdate Ð² Like:', newValue);
            return newValue;
          });
          setMessageUpdate(prev => {
            const newValue = prev + 1;
            console.log('ðŸ”„ MessageUpdate Ð² Like:', newValue);
            return newValue;
          });
          
          // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ
          setShowFullScreenMatch(profile);
          setMatchPhotoIndex(0);
          console.log('ðŸŽ‰ ÐŸÐ¾ÐºÐ°Ð·Ð°Ð½Ð¾ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ');
          return; // ÐÐµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑÑ€Ð°Ð·Ñƒ
        }
      }
    }
    nextProfile();
  };

  const handleSuperLike = () => {
    // Ð¥ÑÐ¿Ñ‚Ð¸Ðº Ñ„Ð¸Ð´Ð±ÐµÐº Ð´Ð»Ñ Telegram
    const tg = getTelegramWebApp();
    if (tg && tg.HapticFeedback) {
      tg.HapticFeedback.impactOccurred('medium');
    }
    
    const profile = profiles[currentProfile];
    console.log('â­ Ð¡ÑƒÐ¿ÐµÑ€ Ð»Ð°Ð¹Ðº Ð½Ð°Ð¶Ð°Ñ‚ Ð´Ð»Ñ:', profile.name);
    console.log('ðŸ” DEBUG - Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ matches:', matches);
    console.log('ðŸ” DEBUG - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ:', matches.find(m => m.id === profile.id));
    console.log('ðŸ” DEBUG - ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑƒÐ¶Ðµ Ð»Ð°Ð¹ÐºÐ½ÑƒÑ‚?', likedProfiles.includes(profile.id));
    
    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð² Ð»Ð°Ð¹ÐºÐ½ÑƒÑ‚Ñ‹Ðµ, ÐµÑÐ»Ð¸ ÐµÑ‰Ðµ Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½
    if (!likedProfiles.includes(profile.id)) {
      setLikedProfiles([...likedProfiles, profile.id]);
      console.log('âœ… ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² Ð»Ð°Ð¹ÐºÐ½ÑƒÑ‚Ñ‹Ðµ');
    }
    
    // Ð¡Ð£ÐŸÐ•Ð  Ð›ÐÐ™Ðš Ð’Ð¡Ð•Ð“Ð”Ð Ð¡ÐžÐ—Ð”ÐÐ•Ð¢ Ð¡ÐžÐ’ÐŸÐÐ”Ð•ÐÐ˜Ð• (100% Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ)
    const existingMatch = matches.find(m => m.id === profile.id);
    console.log('ðŸ” DEBUG - Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐµ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ:', existingMatch);
    
    if (!existingMatch) {
      // ÐšÐ Ð˜Ð¢Ð˜Ð§ÐÐž: ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐž Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð»ÑŽÐ±ÑƒÑŽ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ Ð¡Ð£ÐŸÐ•Ð  Ð›ÐÐ™ÐšÐ
      setChatMessages(prevMessages => {
        console.log('ðŸ§¹ Ð¡Ð£ÐŸÐ•Ð  Ð›ÐÐ™Ðš: ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð´Ð»Ñ', profile.name, 'ID:', profile.id);
        console.log('ðŸ” Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ ÐºÐ»ÑŽÑ‡Ð¸ Ð² chatMessages:', Object.keys(prevMessages));
        console.log('ðŸ” Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð»Ð¸ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð´Ð»Ñ ID', profile.id, ':', !!prevMessages[profile.id]);
        
        if (prevMessages[profile.id]) {
          console.log('ðŸ—‘ï¸ ÐÐÐ™Ð”Ð•ÐÐ ÑÑ‚Ð°Ñ€Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ! Ð£Ð´Ð°Ð»ÑÐµÐ¼', (prevMessages[profile.id] || []).length, 'ÑÑ‚Ð°Ñ€Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹');
        }
        
        // Ð’Ð¡Ð•Ð“Ð”Ð ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚ Ð‘Ð•Ð— ÑÑ‚Ð¾Ð³Ð¾ ÐºÐ»ÑŽÑ‡Ð°
        const cleanMessages = {};
        Object.keys(prevMessages).forEach(key => {
          if (key !== profile.id.toString()) {
            cleanMessages[key] = prevMessages[key];
          }
        });
        
        console.log('âœ… Ð§Ð˜Ð¡Ð¢Ð«Ð• ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ Ð¡Ð£ÐŸÐ•Ð  Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸:', Object.keys(cleanMessages));
        console.log('ðŸ”¥ Ð“ÐÐ ÐÐÐ¢Ð˜Ð¯: Ð´Ð»Ñ Ð¡Ð£ÐŸÐ•Ð  Ð›ÐÐ™ÐšÐ ID', profile.id, 'Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ ÐŸÐžÐ›ÐÐžÐ¡Ð¢Ð¬Ð® Ð£Ð”ÐÐ›Ð•ÐÐ');
        return cleanMessages;
      });
      
      // Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼
      setMatches(prevMatches => {
        const doubleCheck = prevMatches.find(m => m.id === profile.id);
        if (doubleCheck) {
          console.log('âš ï¸ Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¾ - ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚');
          return prevMatches;
        }
        
        const newMatches = [...prevMatches, profile];
        console.log('ðŸ’• Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ Ð¡Ð£ÐŸÐ•Ð  ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ Ñ Ð§Ð˜Ð¡Ð¢ÐžÐ™ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÐµÐ¹:', profile.name);
        console.log('ðŸ” DEBUG - ÐÐ¾Ð²Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº matches:', newMatches);
        console.log('ðŸ“Š DEBUG - Ð Ð°Ð·Ð¼ÐµÑ€ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ¿Ð¸ÑÐºÐ°:', newMatches.length);
        return newMatches;
      });
      
      // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
      setForceUpdate(prev => {
        const newValue = prev + 1;
        console.log('ðŸ”„ ForceUpdate Ð² SuperLike:', newValue);
        return newValue;
      });
      setMessageUpdate(prev => {
        const newValue = prev + 1;
        console.log('ðŸ”„ MessageUpdate Ð² SuperLike:', newValue);
        return newValue;
      });
    } else {
      console.log('âš ï¸ Ð¡Ð¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚, Ð½Ð¾ Ð²ÑÐµ Ñ€Ð°Ð²Ð½Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¾ÐºÐ½Ð¾');
    }
    
    // Ð’Ð¡Ð•Ð“Ð”Ð Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ Ð¿Ñ€Ð¸ ÑÑƒÐ¿ÐµÑ€ Ð»Ð°Ð¹ÐºÐµ
    setShowFullScreenMatch(profile);
    setMatchPhotoIndex(0);
    console.log('ðŸŽ‰ ÐŸÐ¾ÐºÐ°Ð·Ð°Ð½Ð¾ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ');
    console.log('ðŸ” Debug - showFullScreenMatch:', profile);
    console.log('ðŸ” Debug - matchPhotoIndex:', 0);
    
    // ÐÐ• ÐŸÐ•Ð Ð•ÐšÐ›Ð®Ð§ÐÐ•Ðœ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑÑ€Ð°Ð·Ñƒ - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¾ÐºÐ½Ð°
    return;
  };

  const handleDislike = () => {
    // Ð¥ÑÐ¿Ñ‚Ð¸Ðº Ñ„Ð¸Ð´Ð±ÐµÐº Ð´Ð»Ñ Telegram
    const tg = getTelegramWebApp();
    if (tg && tg.HapticFeedback) {
      tg.HapticFeedback.impactOccurred('light');
    }
    
    nextProfile();
  };

  const nextProfile = () => {
    setCurrentProfile((prev) => (prev + 1) % profiles.length);
    setCurrentPhotoIndex(0);
  };

  // Ð£Ð¿Ñ€Ð¾Ñ‰ÐµÐ½Ð½Ñ‹Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÑÐ²Ð°Ð¹Ð¿Ð°
  const handleStart = (clientX, clientY) => {
    console.log('ðŸŽ¯ ÐÐ°Ñ‡Ð°Ð»Ð¾ ÐºÐ°ÑÐ°Ð½Ð¸Ñ Ð´Ð»Ñ ÑÐ²Ð°Ð¹Ð¿Ð°');
    setIsDragging(true);
    setStartPos({ x: clientX, y: clientY });
    setDragDistance(0);
    setDragOffset({ x: 0, y: 0 });
    setIsClick(true);
    
    // ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ ÐºÐ»Ð¸Ðº Ñ‡ÐµÑ€ÐµÐ· Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÑƒÑŽ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÑƒ ÐµÑÐ»Ð¸ Ð½Ð°Ñ‡Ð°Ð»Ð¾ÑÑŒ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ
    setTimeout(() => {
      if (dragDistance > 5) {
        setIsClick(false);
      }
    }, 100);
  };

  const handleMove = (clientX, clientY) => {
    if (!isDragging) return;
    
    const deltaX = clientX - startPos.x;
    const deltaY = clientY - startPos.y;
    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
    
    // Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ, ÑÑ‚Ð¾ Ð½Ðµ ÐºÐ»Ð¸Ðº
    if (distance > 5) {
      setIsClick(false);
    }
    
    setDragOffset({ x: deltaX, y: deltaY });
    setDragDistance(distance);
    console.log('ðŸ“± Ð¡Ð²Ð°Ð¹Ð¿ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ:', { deltaX, deltaY, distance });
  };

  const handleEnd = () => {
    if (!isDragging) return;
    
    console.log('ðŸ›‘ ÐšÐ¾Ð½ÐµÑ† ÐºÐ°ÑÐ°Ð½Ð¸Ñ', { dragDistance, dragOffset, isClick });
    
    // Ð•ÑÐ»Ð¸ ÑÑ‚Ð¾ Ð±Ñ‹Ð» ÑÐ²Ð°Ð¹Ð¿ (Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ)
    const threshold = 60;
    if (!isClick && dragDistance > 20 && Math.abs(dragOffset.x) > threshold) {
      console.log('âœ… Ð¡Ð²Ð°Ð¹Ð¿ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½:', dragOffset.x > 0 ? 'LIKE' : 'DISLIKE');
      if (dragOffset.x > 0) {
        handleLike();
      } else {
        handleDislike();
      }
    }
    
    // Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
    setIsDragging(false);
    setDragOffset({ x: 0, y: 0 });
    setDragDistance(0);
    
    // Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ð»Ñ ÐºÐ»Ð¸ÐºÐ° Ñ‡Ñ‚Ð¾Ð±Ñ‹ onClick ÑƒÑÐ¿ÐµÐ» ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ
    setTimeout(() => {
      setIsClick(false);
    }, 50);
  };

  const handleMouseDown = (e) => {
    e.preventDefault();
    handleStart(e.clientX, e.clientY);
  };

  const handleTouchStart = (e) => {
    const touch = e.touches[0];
    handleStart(touch.clientX, touch.clientY);
  };

  useEffect(() => {
    const handleMouseMove = (e) => {
      e.preventDefault();
      handleMove(e.clientX, e.clientY);
    };
    const handleMouseUp = (e) => {
      e.preventDefault();
      handleEnd();
    };
    const handleTouchMove = (e) => {
      e.preventDefault();
      const touch = e.touches[0];
      handleMove(touch.clientX, touch.clientY);
    };
    const handleTouchEnd = (e) => {
      e.preventDefault();
      handleEnd();
    };

    // Ð¡Ð»ÑƒÑˆÐ°ÐµÐ¼ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ ÑÐ²Ð°Ð¹Ð¿Ð°
    if (isDragging) {
      document.addEventListener('mousemove', handleMouseMove);
      document.addEventListener('mouseup', handleMouseUp);
      document.addEventListener('touchmove', handleTouchMove, { passive: false });
      document.addEventListener('touchend', handleTouchEnd);
      
      return () => {
        document.removeEventListener('mousemove', handleMouseMove);
        document.removeEventListener('mouseup', handleMouseUp);
        document.removeEventListener('touchmove', handleTouchMove);
        document.removeEventListener('touchend', handleTouchEnd);
      };
    }
  }, [isDragging, startPos, dragOffset]);

  // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð²Ð¼ÐµÑÑ‚Ð¾ ref

  // ÐÐ²Ñ‚Ð¾ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ matches
  useEffect(() => {
    try {
      localStorage.setItem('matches', JSON.stringify(matches));
      console.log('ðŸ’¾ ÐÐ²Ñ‚Ð¾ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ matches:', matches.length);
    } catch (e) {
      console.log('âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð°Ð²Ñ‚Ð¾ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ matches:', e);
    }
  }, [matches]);
  
  // ÐÐ²Ñ‚Ð¾ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ likedProfiles  
  useEffect(() => {
    try {
      localStorage.setItem('likedProfiles', JSON.stringify(likedProfiles));
      console.log('ðŸ’¾ ÐÐ²Ñ‚Ð¾ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ likedProfiles:', likedProfiles.length);
    } catch (e) {
      console.log('âš ï¸ ÐžÑˆÐ¸Ð±ÐºÐ° Ð°Ð²Ñ‚Ð¾ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ likedProfiles:', e);
    }
  }, [likedProfiles]);

  // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
  useEffect(() => {
    console.log('ðŸ”„ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸:', messageUpdate);
  }, [messageUpdate, chatMessages]);

  // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹ Ð² Ð¾ÐºÐ½Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ
  useEffect(() => {
    console.log('ðŸ” useEffect - showFullScreenMatch:', !!showFullScreenMatch, showFullScreenMatch?.name);
    if (showFullScreenMatch && showFullScreenMatch.photos && showFullScreenMatch.photos.length > 1) {
      console.log('ðŸ”„ Ð—Ð°Ð¿ÑƒÑÐº Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹');
      const interval = setInterval(() => {
        setMatchPhotoIndex(prev => {
          const newIndex = (prev + 1) % showFullScreenMatch.photos.length;
          console.log('ðŸ“¸ ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ„Ð¾Ñ‚Ð¾:', prev, '->', newIndex);
          return newIndex;
        });
      }, 3000);
      
      return () => {
        console.log('â¹ï¸ ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ');
        clearInterval(interval);
      };
    }
  }, [showFullScreenMatch]);

  // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹ Ð² Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ðµ Ð´ÐµÐ²ÑƒÑˆÐºÐ¸
  useEffect(() => {
    if (showProfileView && showProfileView.photos && showProfileView.photos.length > 1) {
      const interval = setInterval(() => {
        setProfilePhotoIndex(prev => {
          const newIndex = (prev + 1) % showProfileView.photos.length;
          return newIndex;
        });
      }, 4000); // Ð§ÑƒÑ‚ÑŒ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½ÐµÐµ Ñ‡ÐµÐ¼ Ð² Ð¾ÐºÐ½Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ
      
      return () => clearInterval(interval);
    }
  }, [showProfileView]);

  // ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾ÐºÐ½Ð°
  useEffect(() => {
    console.log('ðŸš¨ DEBUG - Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾ÐºÐ½Ð° Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð¾ÑÑŒ:', {
      showFullScreenMatch: !!showFullScreenMatch,
      matchName: showFullScreenMatch?.name,
      matchPhotoIndex: matchPhotoIndex
    });
  }, [showFullScreenMatch, matchPhotoIndex]);

  // ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ matches
  useEffect(() => {
    console.log('ðŸš¨ DEBUG - Matches Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð¸ÑÑŒ:', matches);
  }, [matches]);

  // ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ likedProfiles
  useEffect(() => {
    console.log('ðŸš¨ DEBUG - LikedProfiles Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð¸ÑÑŒ:', likedProfiles);
  }, [likedProfiles]);

  const DiscoverView = () => {
    const profile = profiles[currentProfile];
    const rotation = dragOffset.x * 0.05;
    const opacity = Math.max(0.8, 1 - Math.abs(dragOffset.x) * 0.001);
    
    return (
      <div className="flex flex-col h-full bg-white relative overflow-hidden">
        {/* ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ */}
        <div 
          className="flex-1 relative bg-cover bg-center"
          style={{ 
            backgroundImage: `linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.7) 100%), url('${profile.photos[currentPhotoIndex]}')`,
            transform: `translateX(${isDragging ? dragOffset.x : 0}px) rotate(${isDragging ? rotation : 0}deg)`,
            opacity: isDragging ? opacity : 1,
            transition: isDragging ? 'none' : 'transform 0.3s ease-out, opacity 0.3s ease-out'
          }}
        >
          {/* Stories Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ */}
          <div className="absolute top-4 left-4 right-4 flex space-x-1">
            {profile.photos.map((_, index) => (
              <div
                key={index}
                className="flex-1 h-1 bg-black/30 rounded-full overflow-hidden"
              >
                <div 
                  className={`h-full transition-all duration-300 rounded-full ${
                    index === currentPhotoIndex ? 'bg-white' : 
                    index < currentPhotoIndex ? 'bg-white' : 'bg-transparent'
                  }`}
                />
              </div>
            ))}
          </div>

          {/* ÐžÐ‘ÐÐžÐ’Ð›Ð•ÐÐÐÐ¯ Ð—ÐžÐÐÐ›Ð¬ÐÐÐ¯ Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ */}
          <div className="absolute inset-0 flex z-30">
            {/* ÐšÐ ÐÐ™ÐÐ¯Ð¯ Ð›Ð•Ð’ÐÐ¯ Ð—ÐžÐÐ - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ²Ð°Ð¹Ð¿ (7%) */}
            <div 
              className="cursor-grab"
              style={{ width: '7%' }}
              onMouseDown={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('ðŸ”´ Ð›Ð•Ð’ÐÐ¯ Ð¡Ð’ÐÐ™ÐŸ Ð—ÐžÐÐ (7%) Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°');
                handleMouseDown(e);
              }}
              onTouchStart={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('ðŸ”´ Ð›Ð•Ð’ÐÐ¯ Ð¡Ð’ÐÐ™ÐŸ Ð—ÐžÐÐ (7%) (touch) Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°');
                handleTouchStart(e);
              }}
            />
            
            {/* Ð›Ð•Ð’ÐÐ¯ Ð—ÐžÐÐ ÐšÐ›Ð˜ÐšÐ - Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐµ Ñ„Ð¾Ñ‚Ð¾ (25%) */}
            <div 
              className="cursor-pointer"
              style={{ width: '25%' }}
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                setCurrentPhotoIndex(prev => 
                  prev > 0 ? prev - 1 : profile.photos.length - 1
                );
                console.log('ðŸŸ  Ð›Ð•Ð’ÐÐ¯ Ð¤ÐžÐ¢Ðž Ð—ÐžÐÐ (25%) - Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐµ Ñ„Ð¾Ñ‚Ð¾');
              }}
            />
            
            {/* Ð¦Ð•ÐÐ¢Ð ÐÐ›Ð¬ÐÐÐ¯ Ð—ÐžÐÐ - Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ (36%) */}
            <div 
              className="cursor-pointer"
              style={{ width: '36%' }}
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('ðŸ”µ Ð¦Ð•ÐÐ¢Ð ÐÐ›Ð¬ÐÐÐ¯ Ð—ÐžÐÐ (36%) - ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ');
                console.log('ðŸ‘¤ ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð´Ð»Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ñ:', profile.name);
                setShowProfileView(profile);
                setProfilePhotoIndex(0);
                console.log('âœ… setShowProfileView Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ Ð´Ð»Ñ:', profile.name);
              }}
            />
            
            {/* ÐŸÐ ÐÐ’ÐÐ¯ Ð—ÐžÐÐ ÐšÐ›Ð˜ÐšÐ - ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐµ Ñ„Ð¾Ñ‚Ð¾ (25%) */}
            <div 
              className="cursor-pointer"
              style={{ width: '25%' }}
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                setCurrentPhotoIndex(prev => 
                  prev < profile.photos.length - 1 ? prev + 1 : 0
                );
                console.log('ðŸŸ¡ ÐŸÐ ÐÐ’ÐÐ¯ Ð¤ÐžÐ¢Ðž Ð—ÐžÐÐ (25%) - ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐµ Ñ„Ð¾Ñ‚Ð¾');
              }}
            />
            
            {/* ÐšÐ ÐÐ™ÐÐ¯Ð¯ ÐŸÐ ÐÐ’ÐÐ¯ Ð—ÐžÐÐ - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ²Ð°Ð¹Ð¿ (7%) */}
            <div 
              className="cursor-grab"
              style={{ width: '7%' }}
              onMouseDown={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('ðŸŸ¢ ÐŸÐ ÐÐ’ÐÐ¯ Ð¡Ð’ÐÐ™ÐŸ Ð—ÐžÐÐ (7%) Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°');
                handleMouseDown(e);
              }}
              onTouchStart={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('ðŸŸ¢ ÐŸÐ ÐÐ’ÐÐ¯ Ð¡Ð’ÐÐ™ÐŸ Ð—ÐžÐÐ (7%) (touch) Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°');
                handleTouchStart(e);
              }}
            />
          </div>

          {/* Ð¢ÐµÐ³Ð¸ Ð¿Ñ€Ð¸ ÑÐ²Ð°Ð¹Ð¿Ðµ */}
          {isDragging && !isClick && dragOffset.x > 50 && (
            <div 
              className="absolute top-1/2 left-8 transform -translate-y-1/2 rotate-12 transition-opacity duration-200"
              style={{ opacity: Math.min(1, (dragOffset.x - 50) / 100) }}
            >
              <div className="bg-gradient-to-r from-pink-500 to-pink-600 text-white px-6 py-3 rounded-2xl font-bold text-2xl border-4 border-pink-300 shadow-2xl backdrop-blur-sm">
                <div className="flex items-center space-x-2">
                  <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 4.318c-1.754-1.753-4.596-1.753-6.35 0-1.753 1.754-1.753 4.596 0 6.35L12 17.018l6.35-6.35c1.753-1.754 1.753-4.596 0-6.35-1.754-1.753-4.596-1.753-6.35 0z" />
                  </svg>
                  <span>LIKE</span>
                </div>
              </div>
            </div>
          )}
          {isDragging && !isClick && dragOffset.x < -50 && (
            <div 
              className="absolute top-1/2 right-8 transform -translate-y-1/2 -rotate-12 transition-opacity duration-200"
              style={{ opacity: Math.min(1, (Math.abs(dragOffset.x) - 50) / 100) }}
            >
              <div className="bg-gradient-to-r from-gray-700 to-gray-800 text-white px-6 py-3 rounded-2xl font-bold text-2xl border-4 border-gray-500 shadow-2xl backdrop-blur-sm">
                <div className="flex items-center space-x-2">
                  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                  <span>NOPE</span>
                </div>
              </div>
            </div>
          )}



          {/* Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð²Ð½Ð¸Ð·Ñƒ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ - ÐšÐ›Ð˜ÐšÐÐ‘Ð•Ð›Ð¬ÐÐÐ¯ Ð—ÐžÐÐ */}
          <div 
            className="absolute bottom-0 left-0 right-0 p-6 text-white cursor-pointer z-40"
            onClick={(e) => {
              e.preventDefault();
              e.stopPropagation();
              console.log('ðŸ“‹ ÐšÐ›Ð˜Ðš ÐŸÐž Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜ÐžÐÐÐžÐ™ Ð—ÐžÐÐ• - ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ:', profile.name);
              setShowProfileView(profile);
              setProfilePhotoIndex(0);
            }}
          >
            {/* Ð“ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ñ */}
            <div className="flex items-center mb-3">
              <svg className="w-4 h-4 mr-2 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              <span className="text-white/70 text-sm">{profile.distance} ÐºÐ¼</span>
              <div className="flex items-center ml-3">
                <svg className="w-4 h-4 mr-1 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>
                <span className="text-white/70 text-sm">Ð˜Ñ‰Ñƒ Ñ€Ð¾Ð´ÑÑ‚Ð²ÐµÐ½Ð½ÑƒÑŽ Ð´ÑƒÑˆÑƒ</span>
              </div>
            </div>

            {/* Ð˜Ð¼Ñ Ð¸ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚ */}
            <h2 className="text-3xl font-bold mb-2 flex items-center">
              {profile.name}, {profile.age}
              <svg className="w-6 h-6 ml-2 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </h2>

            {/* ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ */}
            <p className="text-white/90 text-sm mb-4">{profile.bio}</p>

            {/* Ð¢ÐµÐ³Ð¸ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ¾Ð² */}
            <div className="flex flex-wrap gap-2 mb-4">
              {profile.interests.slice(0, 6).map((interest, index) => (
                <div key={index} className="flex items-center bg-black/30 backdrop-blur-sm rounded-full px-3 py-1">
                  {index === 0 && <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>}
                  {index === 1 && <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>}
                  {index === 2 && <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/></svg>}
                  {index === 3 && <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>}
                  {index === 4 && <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/></svg>}
                  {index === 5 && <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>}
                  <span className="text-xs text-white">{interest}</span>
                </div>
              ))}
            </div>
          </div>
        </div>

        {/* ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ */}
        <div className="bg-white p-4">
          <div className="flex justify-center items-center space-x-4">
            <button
              onClick={handleDislike}
              className="w-14 h-14 bg-white rounded-full shadow-lg border border-gray-200 flex items-center justify-center hover:scale-105 transition-transform"
            >
              <svg className="w-7 h-7 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>

            <button
              onClick={handleSuperLike}
              className="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full shadow-lg flex items-center justify-center hover:scale-105 transition-transform relative"
            >
              <svg className="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
              </svg>
            </button>

            <button
              onClick={handleLike}
              className="w-14 h-14 bg-white rounded-full shadow-lg border border-gray-200 flex items-center justify-center hover:scale-105 transition-transform"
            >
              <svg className="w-7 h-7 text-pink-500" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 4.318c-1.754-1.753-4.596-1.753-6.35 0-1.753 1.754-1.753 4.596 0 6.35L12 17.018l6.35-6.35c1.753-1.754 1.753-4.596 0-6.35-1.754-1.753-4.596-1.753-6.35 0z" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    );
  };

  const ChatView = () => {
    console.log('ðŸ’¬ ChatView render - selectedMatch:', selectedMatch);
    
    if (selectedMatch) {
      // Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð· React ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
      const messages = chatMessages[selectedMatch.id] || [];
      
      console.log('ðŸ’¬ ChatView render:', { 
        selectedMatch: selectedMatch.id, 
        selectedMatchName: selectedMatch.name,
        messagesCount: messages.length,
        messageUpdate: messageUpdate,
        forceUpdate: forceUpdate
      });
      
      // Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
      if (messages.length > 0) {
        console.log('ðŸ“‹ Ð’ÑÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð² Ñ‡Ð°Ñ‚Ðµ:');
        messages.forEach((msg, index) => {
          console.log(`  ${index + 1}. [${msg.sender}] "${msg.text}" (ID: ${msg.id}, Ð²Ñ€ÐµÐ¼Ñ: ${new Date(msg.timestamp).toLocaleTimeString()})`);
        });
        
        // ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ð¼ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑÐ¼
        const userMessages = messages.filter(m => m.sender === 'user');
        const matchMessages = messages.filter(m => m.sender === 'match');
        console.log('ðŸ“Š Ð¡Ð¢ÐÐ¢Ð˜Ð¡Ð¢Ð˜ÐšÐ: Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ -', userMessages.length, 'Ð´ÐµÐ²ÑƒÑˆÐºÐ° -', matchMessages.length);
      } else {
        console.log('ðŸ“­ Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð² Ñ‡Ð°Ñ‚Ðµ Ð½ÐµÑ‚ (Ñ‡Ð¸ÑÑ‚Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ)');
      }
      
      return (
        <div className="flex flex-col h-full bg-white">
          {/* Ð¥ÐµÐ´ÐµÑ€ Ñ‡Ð°Ñ‚Ð° */}
          <div className="bg-white p-4 shadow-sm border-b border-gray-100 flex items-center">
            <button
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                setSelectedMatch(null);
                console.log('ðŸ”™ Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ Ðº ÑÐ¿Ð¸ÑÐºÑƒ Ñ‡Ð°Ñ‚Ð¾Ð²');
              }}
              className="mr-3 p-2 hover:bg-gray-100 rounded-full transition-colors"
            >
              <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
              </svg>
            </button>
            <button
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                setShowProfileView(selectedMatch);
                setProfilePhotoIndex(0);
                console.log('ðŸ‘¤ ÐšÐ»Ð¸Ðº Ð½Ð° Ð°Ð²Ð°Ñ‚Ð°Ñ€ Ð² Ñ…ÐµÐ´ÐµÑ€Ðµ - Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ:', selectedMatch.name);
              }}
              className="flex items-center flex-1 hover:bg-gray-50 p-2 rounded-lg transition-colors"
            >
              <img 
                src={selectedMatch.photos && selectedMatch.photos[0] ? selectedMatch.photos[0] : 'keys/default_avatar?prompt=Beautiful%20young%20woman%20portrait%20default%20avatar'}
                alt={selectedMatch.name}
                className="w-10 h-10 rounded-full object-cover border-2 border-pink-200 mr-3"
              />
              <div className="flex-1 text-left">
                <h3 className="font-semibold text-gray-800">{selectedMatch.name}</h3>
                <p className="text-sm text-gray-500">ÐžÐ½Ð»Ð°Ð¹Ð½</p>
              </div>
            </button>
            
            {/* ÐšÐ½Ð¾Ð¿ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‡Ð°Ñ‚Ð° */}
            <button
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                const chatIdToDelete = selectedMatch.id;
                console.log('ðŸ—‘ï¸ ÐšÐ»Ð¸Ðº Ð½Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‡Ð°Ñ‚Ð° Ð¸Ð· Ñ…ÐµÐ´ÐµÑ€Ð°:', chatIdToDelete);
                setDeletingChat(chatIdToDelete);
              }}
              className="p-2 hover:bg-gray-100 rounded-full transition-colors"
              title="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‡Ð°Ñ‚"
              disabled={deletingChat !== null} // Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ»Ð¸ÐºÐ¾Ð²
            >
              <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          </div>

          {/* Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ */}
          <div 
            className="flex-1 overflow-y-auto p-4 space-y-3"
            ref={(el) => {
              if (el) {
                // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ° Ðº Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ¼Ñƒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑŽ
                setTimeout(() => {
                  el.scrollTop = el.scrollHeight;
                }, 100);
              }
            }}
          >
            {messages.length === 0 ? (
              <div className="flex flex-col items-center justify-center h-full">
                <div className="text-4xl mb-4">ðŸ’</div>
                <h4 className="text-lg font-semibold text-gray-800 mb-2">Ð¡Ð¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ!</h4>
                <p className="text-gray-500 text-center">Ð’Ñ‹ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»Ð¸ÑÑŒ Ð´Ñ€ÑƒÐ³ Ð´Ñ€ÑƒÐ³Ñƒ! ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€</p>
              </div>
            ) : (
              messages.map((msg, index) => (
                <div
                  key={`msg-${msg.id}-${index}-${messageUpdate}`}
                  className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}
                >
                  <div
                    className={`max-w-xs px-4 py-2 rounded-2xl ${
                      msg.sender === 'user'
                        ? 'bg-pink-500 text-white ml-12'
                        : 'bg-gray-100 text-gray-800 mr-12'
                    }`}
                  >
                    <p className="text-sm">{msg.text}</p>
                  </div>
                </div>
              ))
            )}
          </div>

          {/* ÐŸÐ¾Ð»Ðµ Ð²Ð²Ð¾Ð´Ð° - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð¼ÐµÐ¼Ð¾Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ */}
          <ChatInput 
            matchId={selectedMatch.id} 
            onSendMessage={sendMessage} 
          />
          
          {/* ÐœÐ¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ */}
          {deletingChat === selectedMatch.id && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
              <div className="bg-white p-6 rounded-lg max-w-sm mx-4">
                <h3 className="text-lg font-semibold text-gray-800 mb-3">Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‡Ð°Ñ‚?</h3>
                <p className="text-gray-600 mb-6">
                  Ð’ÑÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ {selectedMatch.name} Ð±ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹. Ð­Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð½ÐµÐ»ÑŒÐ·Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ.
                </p>
                <div className="flex space-x-3">
                  <button
                    onClick={() => setDeletingChat(null)}
                    className="flex-1 py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
                  >
                    ÐžÑ‚Ð¼ÐµÐ½Ð°
                  </button>
                  <button
                    onClick={(e) => {
                      e.preventDefault();
                      e.stopPropagation();
                      
                      const matchIdToDelete = deletingChat; // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ID Ð¸Ð· ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
                      console.log('ðŸ—‘ï¸ ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‡Ð°Ñ‚Ð° Ð¸Ð· Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¾Ð³Ð¾ Ð¾ÐºÐ½Ð°:', matchIdToDelete);
                      
                      // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¼Ð¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾
                      setDeletingChat(null);
                      
                      // Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ñ‡Ð°Ñ‚ Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ Ð´Ð»Ñ Ð¸Ð·Ð±ÐµÐ¶Ð°Ð½Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ð¾Ð²
                      setTimeout(() => {
                        deleteChat(matchIdToDelete);
                      }, 100);
                    }}
                    className="flex-1 py-2 px-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                    disabled={!deletingChat} // Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ ÐºÐ»Ð¸ÐºÐ°
                  >
                    Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    return (
      <div className="flex flex-col h-full bg-white">
        <div className="bg-white p-4 shadow-sm border-b border-gray-100">
          <h2 className="text-xl font-bold text-gray-800">Ð§Ð°Ñ‚Ñ‹</h2>
          <p className="text-gray-500 text-sm">{matches.length} ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹</p>
          {/* Ð¡ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ */}
          <div style={{ display: 'none' }}>{forceUpdate}-{messageUpdate}-{matches.length}-{JSON.stringify(matches.map(m => m.id))}</div>
          {/* ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ */}
          <div style={{ display: 'none' }}>
            DEBUG: matches={JSON.stringify(matches.map(m => ({ id: m.id, name: m.name })))}, forceUpdate={forceUpdate}, messageUpdate={messageUpdate}, timestamp={Date.now()}
          </div>
        </div>
        
        <div className="flex-1 overflow-y-auto">
          {matches.length === 0 ? (
            <div className="flex flex-col items-center justify-center h-full p-8">
              <div className="text-6xl mb-4">ðŸ’¬</div>
              <h3 className="text-lg font-semibold text-gray-800 mb-2">ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹</h3>
              <p className="text-gray-500 text-center">ÐšÐ¾Ð³Ð´Ð° Ð²Ñ‹ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÐµÑÑŒ Ð´Ñ€ÑƒÐ³ Ð´Ñ€ÑƒÐ³Ñƒ, Ð·Ð´ÐµÑÑŒ Ð¿Ð¾ÑÐ²ÑÑ‚ÑÑ Ð²Ð°ÑˆÐ¸ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ</p>
            </div>
          ) : (
            <div className="p-4 space-y-3" key={`matches-list-${matches.length}-${forceUpdate}-${messageUpdate}-${JSON.stringify(matches.map(m => m.id))}`}>
              {matches.map((match, index) => (
                <div 
                  key={`match-${match.id}-${index}-${forceUpdate}-${messageUpdate}`}
                  className="flex items-center p-3 bg-white rounded-lg border border-gray-100 hover:bg-gray-50 cursor-pointer group"
                >
                  <div 
                    onClick={() => setSelectedMatch(match)}
                    className="flex items-center flex-1"
                  >
                    <img 
                      src={match.photos && match.photos[0] ? match.photos[0] : 'keys/default_avatar?prompt=Beautiful%20young%20woman%20portrait%20default%20avatar'}
                      alt={match.name}
                      className="w-14 h-14 rounded-full object-cover border-2 border-pink-200"
                    />
                    <div className="ml-3 flex-1">
                      <h4 className="font-semibold text-gray-800">{match.name}</h4>
                      <p className="text-sm text-gray-500">
                        {chatMessages[match.id] && chatMessages[match.id].length > 0
                          ? chatMessages[match.id][chatMessages[match.id].length - 1].text
                          : "Ð’Ñ‹ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»Ð¸ÑÑŒ Ð´Ñ€ÑƒÐ³ Ð´Ñ€ÑƒÐ³Ñƒ!"}
                      </p>
                    </div>
                    <div className="w-3 h-3 bg-pink-500 rounded-full"></div>
                  </div>
                  
                  {/* ÐšÐ½Ð¾Ð¿ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ (Ð¿Ð¾ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð½Ð°Ð²ÐµÐ´ÐµÐ½Ð¸Ð¸) */}
                  <button
                    onClick={(e) => {
                      e.preventDefault();
                      e.stopPropagation();
                      const chatIdToDelete = match.id;
                      console.log('ðŸ—‘ï¸ ÐšÐ»Ð¸Ðº Ð½Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‡Ð°Ñ‚Ð° Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°:', chatIdToDelete);
                      setDeletingChat(chatIdToDelete);
                    }}
                    className="ml-2 p-2 hover:bg-red-100 rounded-full transition-colors opacity-0 group-hover:opacity-100"
                    title="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‡Ð°Ñ‚"
                    disabled={deletingChat !== null} // Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ»Ð¸ÐºÐ¾Ð²
                  >
                    <svg className="w-4 h-4 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                  </button>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    );
  };

  // ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ¸
  const GirlProfileView = ({ profile, onClose }) => {
    return (
      <div 
        className="fixed inset-0 bg-white flex flex-col"
        style={{ 
          zIndex: 999999,
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          width: '100vw',
          height: '100vh'
        }}
      >
        {/* Ð¥ÐµÐ´ÐµÑ€ */}
        <div className="bg-white p-4 shadow-sm border-b border-gray-100 flex items-center">
          <button
            onClick={onClose}
            className="mr-3 p-2 hover:bg-gray-100 rounded-full transition-colors"
          >
            <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
            </svg>
          </button>
          <h2 className="text-xl font-bold text-gray-800">{profile.name}</h2>
        </div>

        {/* ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ */}
        <div className="flex-1 overflow-y-auto">
          {/* Ð“Ð»Ð°Ð²Ð½Ð°Ñ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ */}
          <div className="relative h-96 bg-gray-200">
            {/* Stories Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ */}
            <div className="absolute top-4 left-4 right-4 flex space-x-1 z-10">
              {profile.photos.map((_, index) => (
                <div
                  key={index}
                  className="flex-1 h-1 bg-black/30 rounded-full overflow-hidden"
                >
                  <div 
                    className={`h-full transition-all duration-300 rounded-full ${
                      index === profilePhotoIndex ? 'bg-white' : 
                      index < profilePhotoIndex ? 'bg-white' : 'bg-transparent'
                    }`}
                  />
                </div>
              ))}
            </div>

            <img 
              src={profile.photos[profilePhotoIndex]}
              alt={profile.name}
              className="w-full h-full object-cover"
            />

            {/* ÐšÐ»Ð¸Ðº Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ„Ð¾Ñ‚Ð¾ */}
            <div className="absolute inset-0 flex">
              <button 
                className="flex-1"
                onClick={() => setProfilePhotoIndex(prev => 
                  prev > 0 ? prev - 1 : profile.photos.length - 1
                )}
              />
              <button 
                className="flex-1"
                onClick={() => setProfilePhotoIndex(prev => 
                  prev < profile.photos.length - 1 ? prev + 1 : 0
                )}
              />
            </div>
          </div>

          {/* Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ */}
          <div className="p-6 space-y-6">
            {/* Ð˜Ð¼Ñ Ð¸ Ð¾ÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ */}
            <div>
              <div className="flex items-center mb-3">
                <h1 className="text-3xl font-bold text-gray-800">{profile.name}, {profile.age}</h1>
                <svg className="w-6 h-6 ml-2 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              
              <div className="flex items-center text-gray-600 mb-3">
                <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                <span className="text-sm">{profile.distance} ÐºÐ¼ Ð¾Ñ‚ Ð²Ð°Ñ â€¢ {profile.city}</span>
              </div>

              {profile.job && (
                <div className="flex items-center text-gray-600 mb-3">
                  <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2V6" />
                  </svg>
                  <span className="text-sm">{profile.job}</span>
                </div>
              )}

              {profile.education && (
                <div className="flex items-center text-gray-600 mb-3">
                  <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 14l9-5-9-5-9 5 9 5z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
                  </svg>
                  <span className="text-sm">{profile.education}</span>
                </div>
              )}

              {profile.height && (
                <div className="flex items-center text-gray-600 mb-4">
                  <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 21l3-3-3-3M14 3l3 3-3 3M4 12h16" />
                  </svg>
                  <span className="text-sm">{profile.height}</span>
                </div>
              )}
            </div>

            {/* ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ */}
            {profile.bio && (
              <div>
                <h3 className="text-lg font-semibold text-gray-800 mb-2">Ðž ÑÐµÐ±Ðµ</h3>
                <p className="text-gray-600 leading-relaxed">{profile.bio}</p>
              </div>
            )}

            {/* Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÑ‹ */}
            {profile.interests && profile.interests.length > 0 && (
              <div>
                <h3 className="text-lg font-semibold text-gray-800 mb-3">Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÑ‹</h3>
                <div className="flex flex-wrap gap-2">
                  {profile.interests.map((interest, index) => (
                    <span 
                      key={index}
                      className="bg-pink-100 text-pink-700 px-3 py-2 rounded-full text-sm border border-pink-200"
                    >
                      {interest}
                    </span>
                  ))}
                </div>
              </div>
            )}

            {/* Ð’ÑÐµ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸ */}
            {profile.photos && profile.photos.length > 1 && (
              <div>
                <h3 className="text-lg font-semibold text-gray-800 mb-3">Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸</h3>
                <div className="grid grid-cols-2 gap-3">
                  {profile.photos.map((photo, index) => (
                    <button
                      key={index}
                      onClick={() => setProfilePhotoIndex(index)}
                      className={`aspect-square rounded-lg overflow-hidden border-2 transition-all ${
                        index === profilePhotoIndex ? 'border-pink-500 scale-95' : 'border-gray-200 hover:border-gray-300'
                      }`}
                    >
                      <img 
                        src={photo}
                        alt={`${profile.name} Ñ„Ð¾Ñ‚Ð¾ ${index + 1}`}
                        className="w-full h-full object-cover"
                      />
                    </button>
                  ))}
                </div>
              </div>
            )}
          </div>
        </div>

        {/* ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ */}
        <div className="bg-white p-4 border-t border-gray-100">
          <div className="flex space-x-3">
            <button
              onClick={onClose}
              className="flex-1 bg-gray-100 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-200 transition-colors"
            >
              Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ
            </button>
            
            {/* ÐšÐ½Ð¾Ð¿ÐºÐ° Ð»Ð°Ð¹ÐºÐ° Ð¸Ð»Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð° Ðº Ñ‡Ð°Ñ‚Ñƒ ÐµÑÐ»Ð¸ ÑƒÐ¶Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ */}
            {matches.find(m => m.id === profile.id) ? (
              <button
                onClick={() => {
                  setSelectedMatch(profile);
                  setCurrentView('chats');
                  onClose();
                }}
                className="flex-1 bg-pink-500 text-white py-3 rounded-lg font-semibold hover:bg-pink-600 transition-colors"
              >
                ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ðº Ñ‡Ð°Ñ‚Ñƒ
              </button>
            ) : (
              <button
                onClick={() => {
                  // Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ ÐµÑ‰Ðµ Ð½Ðµ Ð»Ð°Ð¹ÐºÐ½ÑƒÑ‚, Ð»Ð°Ð¹ÐºÐ°ÐµÐ¼
                  if (!likedProfiles.includes(profile.id)) {
                    setLikedProfiles([...likedProfiles, profile.id]);
                    
                    // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ Ñ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒÑŽ
                    if (Math.random() > 0.3) {
                      setMatches(prev => {
                        if (prev.find(m => m.id === profile.id)) return prev;
                        return [...prev, profile];
                      });
                      
                      // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¾ÐºÐ½Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ
                      setShowFullScreenMatch(profile);
                    }
                  }
                  onClose();
                }}
                className="flex-1 bg-pink-500 text-white py-3 rounded-lg font-semibold hover:bg-pink-600 transition-colors flex items-center justify-center"
              >
                <svg className="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 4.318c-1.754-1.753-4.596-1.753-6.35 0-1.753 1.754-1.753 4.596 0 6.35L12 17.018l6.35-6.35c1.753-1.754 1.753-4.596 0-6.35-1.754-1.753-4.596-1.753-6.35 0z" />
                </svg>
                Ð›Ð°Ð¹Ðº
              </button>
            )}
          </div>
        </div>
      </div>
    );
  };

  const ProfileView = () => {
    return (
      <div className="flex flex-col h-full bg-white">
        <div className="bg-white p-4 shadow-sm border-b border-gray-100">
          <h2 className="text-xl font-bold text-gray-800">ÐœÐ¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ</h2>
          <p className="text-sm text-gray-500">ID: {currentUser.telegramId}</p>
        </div>
        
        <div className="flex-1 overflow-y-auto p-6">
          {/* ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ */}
          <div className="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <div className="flex items-center mb-2">
              <svg className="w-5 h-5 text-blue-600 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <span className="font-semibold text-blue-800">ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ</span>
            </div>
            <div className="text-sm text-blue-700 space-y-1">
              <p><strong>Telegram Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½:</strong> {getTelegramWebApp() ? 'Ð”Ð° âœ…' : 'ÐÐµÑ‚ âŒ'}</p>
              <p><strong>Platform:</strong> {getTelegramWebApp()?.platform || 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾'}</p>
              <p><strong>Version:</strong> {getTelegramWebApp()?.version || 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾'}</p>
              <p><strong>InitData ÐµÑÑ‚ÑŒ:</strong> {getTelegramWebApp()?.initData ? 'Ð”Ð° âœ…' : 'ÐÐµÑ‚ âŒ'}</p>
              <p><strong>User Ð´Ð°Ð½Ð½Ñ‹Ðµ:</strong> {getTelegramWebApp()?.initDataUnsafe?.user ? 'Ð•ÑÑ‚ÑŒ âœ…' : 'ÐÐµÑ‚ âŒ'}</p>
              <p><strong>ÐžÑˆÐ¸Ð±ÐºÐ° Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸:</strong> {authError || 'ÐÐµÑ‚'}</p>
            </div>
            <button
              onClick={() => {
                const tg = getTelegramWebApp();
                const debugInfo = {
                  telegramAvailable: !!tg,
                  platform: tg?.platform,
                  version: tg?.version,
                  initData: !!tg?.initData,
                  user: tg?.initDataUnsafe?.user,
                  currentURL: window.location.href,
                  userAgent: navigator.userAgent
                };
                console.log('ðŸ” ÐŸÐžÐ›ÐÐÐ¯ ÐžÐ¢Ð›ÐÐ”ÐžÐ§ÐÐÐ¯ Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜Ð¯:', debugInfo);
                navigator.clipboard?.writeText(JSON.stringify(debugInfo, null, 2));
                alert('ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð¸ Ð±ÑƒÑ„ÐµÑ€ Ð¾Ð±Ð¼ÐµÐ½Ð°');
              }}
              className="mt-2 px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600 transition-colors"
            >
              Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ñ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ
            </button>
          </div>

          {/* Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾Ð± Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ */}
          <div className="mb-6 p-4 bg-green-50 rounded-lg border border-green-200">
            <div className="flex items-center mb-2">
              <svg className="w-5 h-5 text-green-600 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <span className="font-semibold text-green-800">ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½ Ñ‡ÐµÑ€ÐµÐ· Telegram</span>
            </div>
            <div className="text-sm text-green-700 space-y-1">
              <p><strong>Ð˜Ð¼Ñ:</strong> {currentUser.firstName} {currentUser.lastName}</p>
              {currentUser.username && <p><strong>Username:</strong> @{currentUser.username}</p>}
              <p><strong>Ð¯Ð·Ñ‹Ðº:</strong> {currentUser.languageCode?.toUpperCase() || 'RU'}</p>
              {currentUser.isPremium && (
                <p className="flex items-center">
                  <span className="text-yellow-600 mr-1">â­</span>
                  <strong>Telegram Premium</strong>
                </p>
              )}
            </div>
          </div>

          <div className="text-center mb-6">
            <img 
              src={currentUser.photos[0]}
              alt={currentUser.name}
              className="w-32 h-32 rounded-full mx-auto object-cover border-4 border-pink-200 mb-4"
            />
            <h3 className="text-2xl font-bold text-gray-800">{currentUser.name}, {currentUser.age}</h3>
            <p className="text-gray-600 mt-2">{currentUser.bio}</p>
          </div>

          <div className="space-y-6">
            <div>
              <h4 className="font-semibold text-gray-800 mb-3">ÐœÐ¾Ð¸ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑ‹</h4>
              <div className="flex flex-wrap gap-2">
                {currentUser.interests.map((interest, index) => (
                  <span 
                    key={index}
                    className="bg-pink-100 text-pink-700 px-3 py-1 rounded-full text-sm border border-pink-200"
                  >
                    {interest}
                  </span>
                ))}
              </div>
            </div>

            <div>
              <h4 className="font-semibold text-gray-800 mb-3">ÐœÐ¾Ð¸ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸</h4>
              <div className="grid grid-cols-3 gap-2">
                {currentUser.photos.map((photo, index) => (
                  <img 
                    key={index}
                    src={photo}
                    alt={`Ð¤Ð¾Ñ‚Ð¾ ${index + 1}`}
                    className="aspect-square rounded-lg object-cover border border-gray-200"
                  />
                ))}
              </div>
            </div>

            <button className="w-full bg-pink-500 text-white py-3 rounded-lg font-semibold hover:bg-pink-600 transition-colors mb-3">
              Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ
            </button>
            
            <button 
              onClick={() => {
                if (window.confirm('Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ð’Ð¡Ð• Ñ‡Ð°Ñ‚Ñ‹ Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ? Ð­Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð½ÐµÐ»ÑŒÐ·Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ.')) {
                  clearAllChats();
                  alert('Ð’ÑÐµ Ñ‡Ð°Ñ‚Ñ‹ Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ñ‹');
                }
              }}
              className="w-full bg-red-500 text-white py-3 rounded-lg font-semibold hover:bg-red-600 transition-colors"
            >
              ðŸ§¹ ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ð²ÑÐµ Ñ‡Ð°Ñ‚Ñ‹
            </button>
          </div>
        </div>
      </div>
    );
  };

  // ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸
  const LoadingView = () => (
    <div className="flex flex-col items-center justify-center h-full bg-gradient-to-br from-pink-500 to-purple-600">
      <div className="text-white text-center">
        <div className="text-6xl mb-6">ðŸ’•</div>
        <h1 className="text-3xl font-bold mb-4">True Love</h1>
        <div className="animate-spin w-8 h-8 border-4 border-white border-t-transparent rounded-full mx-auto mb-4"></div>
        <p className="text-white/80">
          {!isAuthenticated && !authError ? 'ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ...' : 'Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ...'}
        </p>
        {authError && (
          <div className="mt-4 p-3 bg-red-500/20 rounded-lg">
            <p className="text-sm text-red-100">âš ï¸ {authError}</p>
            <div className="space-y-2">
              <button
                onClick={() => authenticateUser()}
                className="w-full px-4 py-2 bg-white/20 rounded-lg text-sm hover:bg-white/30 transition-colors"
              >
                ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ
              </button>
              <button
                onClick={() => {
                  console.log('ðŸ”„ ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Telegram Ð´Ð°Ð½Ð½Ñ‹Ñ…:');
                  const tg = getTelegramWebApp();
                  if (tg) {
                    console.log('âœ… WebApp Ð½Ð°Ð¹Ð´ÐµÐ½:', tg);
                    console.log('ðŸ“± initDataUnsafe:', tg.initDataUnsafe);
                    console.log('ðŸ‘¤ User:', tg.initDataUnsafe?.user);
                    if (tg.initDataUnsafe?.user) {
                      alert(`ÐÐ°Ð¹Ð´ÐµÐ½ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: ${tg.initDataUnsafe.user.first_name} (ID: ${tg.initDataUnsafe.user.id})`);
                    } else {
                      alert('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Telegram Ð±Ð¾Ñ‚Ð°.');
                    }
                  } else {
                    alert('Telegram WebApp Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð² Telegram.');
                  }
                }}
                className="w-full px-4 py-2 bg-blue-500/20 rounded-lg text-sm hover:bg-blue-500/30 transition-colors"
              >
                ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Telegram
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );

  // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ Ð¿Ð¾ÐºÐ° Ð¸Ð´ÐµÑ‚ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
  if (!isAuthenticated || !currentUser) {
    return (
      <div 
        className="w-full h-full max-w-md mx-auto flex flex-col relative"
        style={{
          backgroundColor: getTelegramWebApp()?.themeParams?.bg_color || '#FFFFFF',
          color: getTelegramWebApp()?.themeParams?.text_color || '#000000'
        }}
      >
        <LoadingView />
      </div>
    );
  }

  return (
    <>
      <div 
        className="w-full h-full max-w-md mx-auto flex flex-col relative"
        style={{
          backgroundColor: getTelegramWebApp()?.themeParams?.bg_color || '#FFFFFF',
          color: getTelegramWebApp()?.themeParams?.text_color || '#000000'
        }}
      >
        {/* ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ */}
        <div className="flex-1 overflow-hidden">
          {currentView === 'discover' && <DiscoverView />}
          {currentView === 'chats' && <ChatView />}
          {currentView === 'profile' && <ProfileView />}
        </div>
      
      {/* Tab bar */}
      <div className="bg-white border-t border-gray-200 flex shrink-0">
        <button
          onClick={() => {
            console.log('ðŸ“± ÐšÐ»Ð¸Ðº Ð½Ð° Ð²ÐºÐ»Ð°Ð´ÐºÑƒ Ñ‡Ð°Ñ‚Ð¾Ð² - currentView:', currentView, 'selectedMatch:', selectedMatch);
            
            // Ð•ÑÐ»Ð¸ Ð¼Ñ‹ ÑƒÐ¶Ðµ Ð² Ñ‡Ð°Ñ‚Ð°Ñ… Ð¸ ÐµÑÑ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ñ‡Ð°Ñ‚, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ðº ÑÐ¿Ð¸ÑÐºÑƒ
            if (currentView === 'chats' && selectedMatch) {
              setSelectedMatch(null);
              console.log('ðŸ”™ Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ Ðº ÑÐ¿Ð¸ÑÐºÑƒ Ñ‡Ð°Ñ‚Ð¾Ð² Ð¸Ð· Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¾Ð³Ð¾ Ñ‡Ð°Ñ‚Ð°');
            } else {
              // ÐŸÑ€Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ðµ Ð¸Ð· Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð²ÐºÐ»Ð°Ð´Ð¾Ðº - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¼ÐµÐ½ÑÐµÐ¼ Ð²Ð¸Ð´
              setCurrentView('chats');
              console.log('ðŸ“± ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ð² Ñ€Ð°Ð·Ð´ÐµÐ» Ñ‡Ð°Ñ‚Ð¾Ð²');
            }
          }}
          className={`flex-1 py-3 px-4 text-center transition-colors ${
            currentView === 'chats' ? 'text-pink-500' : 'text-gray-400'
          }`}
        >
          <div className="w-6 h-6 mx-auto mb-1">
            <svg fill="currentColor" viewBox="0 0 24 24">
              <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
            </svg>
          </div>
        </button>
        
        <button
          onClick={() => setCurrentView('discover')}
          className={`flex-1 py-3 px-4 text-center transition-colors ${
            currentView === 'discover' ? 'text-pink-500' : 'text-gray-400'
          }`}
        >
          <div className="w-6 h-6 mx-auto mb-1">
            <svg fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
        </button>
        
        <button
          onClick={() => setCurrentView('profile')}
          className={`flex-1 py-3 px-4 text-center transition-colors ${
            currentView === 'profile' ? 'text-pink-500' : 'text-gray-400'
          }`}
        >
          <div className="w-6 h-6 mx-auto mb-1">
            <svg fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
          </div>
        </button>
      </div>

      {/* ÐŸÐžÐ›ÐÐžÐ­ÐšÐ ÐÐÐÐžÐ• ÐžÐšÐÐž Ð¡ÐžÐ’ÐŸÐÐ”Ð•ÐÐ˜Ð¯ */}
      {showFullScreenMatch && (
        <div 
          className="fixed inset-0 bg-black flex flex-col"
          style={{ zIndex: 9999 }}
        >
          {/* Ð¤Ð¾Ð½ Ñ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸ÐµÐ¹ Ð´ÐµÐ²ÑƒÑˆÐºÐ¸ */}
          <div 
            className="flex-1 relative bg-cover bg-center"
            style={{ 
              backgroundImage: `linear-gradient(to bottom, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.8) 100%), url('${showFullScreenMatch.photos[matchPhotoIndex]}')` 
            }}
          >
            {/* Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹ */}
            <div className="absolute top-8 left-4 right-4 flex space-x-1">
              {showFullScreenMatch.photos.map((_, index) => (
                <div
                  key={index}
                  className="flex-1 h-1 bg-white/30 rounded-full overflow-hidden"
                >
                  <div 
                    className={`h-full transition-all duration-300 rounded-full ${
                      index === matchPhotoIndex ? 'bg-white' : 
                      index < matchPhotoIndex ? 'bg-white' : 'bg-transparent'
                    }`}
                  />
                </div>
              ))}
            </div>

            {/* ÐšÐ½Ð¾Ð¿ÐºÐ° Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ */}
            <button
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('âŒ ÐžÐºÐ½Ð¾ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¾ Ñ‡ÐµÑ€ÐµÐ· ÐºÐ½Ð¾Ð¿ÐºÑƒ X - Ñ‡Ð°Ñ‚ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¾ÑÑ‚Ð°Ñ‚ÑŒÑÑ Ð² ÑÐ¿Ð¸ÑÐºÐµ');
                
                const currentMatch = showFullScreenMatch;
                console.log('ðŸ” Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¼Ð°Ñ‚Ñ‡ Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ:', currentMatch);
                
                // Ð£Ð±ÐµÐ¶Ð´Ð°ÐµÐ¼ÑÑ Ñ‡Ñ‚Ð¾ Ñ‡Ð°Ñ‚ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð² ÑÐ¿Ð¸ÑÐºÐµ matches Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¾Ð¹ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
                setMatches(prevMatches => {
                  const existingMatch = prevMatches.find(m => m.id === currentMatch.id);
                  console.log('ðŸ” Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ð¼Ð°Ñ‚Ñ‡ Ð² ÑÐ¿Ð¸ÑÐºÐµ:', existingMatch);
                  console.log('ðŸ“Š Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€ ÑÐ¿Ð¸ÑÐºÐ° matches:', prevMatches.length);
                  
                  if (!existingMatch) {
                    console.log('âœ… Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¼Ð°Ñ‚Ñ‡ Ð² ÑÐ¿Ð¸ÑÐ¾Ðº');
                    const updatedMatches = [...prevMatches, currentMatch];
                    console.log('ðŸ“‹ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº matches:', updatedMatches);
                    console.log('ðŸ“Š ÐÐ¾Ð²Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€ ÑÐ¿Ð¸ÑÐºÐ°:', updatedMatches.length);
                    return updatedMatches;
                  } else {
                    console.log('â„¹ï¸ ÐœÐ°Ñ‚Ñ‡ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð² ÑÐ¿Ð¸ÑÐºÐµ');
                    return prevMatches;
                  }
                });
                
                // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²ÑÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
                setForceUpdate(prev => {
                  const newValue = prev + 1;
                  console.log('ðŸ”„ ForceUpdate Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½:', newValue);
                  return newValue;
                });
                
                setMessageUpdate(prev => {
                  const newValue = prev + 1;
                  console.log('ðŸ”„ MessageUpdate Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½:', newValue);
                  return newValue;
                });
                
                // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¾ÐºÐ½Ð¾ Ð¸ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ
                setShowFullScreenMatch(null);
                nextProfile();
                
                // Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÑƒ
                setTimeout(() => {
                  setForceUpdate(prev => prev + 1);
                  setMessageUpdate(prev => prev + 1);
                  console.log('ðŸ”„ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾');
                }, 200);
              }}
              className="absolute top-8 right-4 p-3 bg-black/50 rounded-full backdrop-blur-sm hover:bg-black/70 transition-colors z-10"
            >
              <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>

            {/* ÐžÐ±Ð»Ð°ÑÑ‚Ð¸ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹ */}
            <div className="absolute inset-0 flex">
              <button 
                className="flex-1"
                onClick={() => setMatchPhotoIndex(prev => 
                  prev > 0 ? prev - 1 : showFullScreenMatch.photos.length - 1
                )}
              />
              <button 
                className="flex-1"
                onClick={() => setMatchPhotoIndex(prev => 
                  prev < showFullScreenMatch.photos.length - 1 ? prev + 1 : 0
                )}
              />
            </div>

            {/* Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð°Ñ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ñ ÑÐµÑ€Ð´ÐµÑ† */}
            <div className="absolute inset-0 flex items-center justify-center">
              <div className="text-center">
                <div className="text-8xl mb-4 animate-pulse">ðŸ’•</div>
                <h2 className="text-4xl font-bold text-white mb-2 animate-bounce">
                  It's a Match!
                </h2>
                <h3 className="text-2xl font-bold text-white mb-1">
                  Ð’Ð·Ð°Ð¸Ð¼Ð½Ð°Ñ ÑÐ¸Ð¼Ð¿Ð°Ñ‚Ð¸Ñ
                </h3>
                <p className="text-white/90 text-lg">
                  Ð’Ñ‹ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»Ð¸ÑÑŒ Ð´Ñ€ÑƒÐ³ Ð´Ñ€ÑƒÐ³Ñƒ!
                </p>
              </div>
            </div>

            {/* Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð´ÐµÐ²ÑƒÑˆÐºÐµ Ð²Ð½Ð¸Ð·Ñƒ */}
            <div className="absolute bottom-0 left-0 right-0 p-6 text-white">
              <div className="text-center mb-6">
                <h3 className="text-3xl font-bold mb-2">
                  {showFullScreenMatch.name}, {showFullScreenMatch.age}
                </h3>
                <div className="flex justify-center items-center mb-3">
                  <svg className="w-4 h-4 mr-2 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                  <span className="text-white/90">{showFullScreenMatch.distance} ÐºÐ¼ â€¢ {showFullScreenMatch.city}</span>
                </div>
                <p className="text-white/80 text-sm mb-4">{showFullScreenMatch.bio}</p>
                
                {/* Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÑ‹ */}
                <div className="flex flex-wrap justify-center gap-2 mb-6">
                  {showFullScreenMatch.interests.slice(0, 4).map((interest, index) => (
                    <span 
                      key={index}
                      className="bg-white/20 backdrop-blur-sm rounded-full px-3 py-1 text-xs text-white"
                    >
                      {interest}
                    </span>
                  ))}
                </div>
              </div>

              {/* ÐšÐ½Ð¾Ð¿ÐºÐ° */}
              <div className="px-4">
                <button
                  onClick={() => {
                    const currentMatch = showFullScreenMatch;
                    console.log('ðŸ’¬ ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ‡Ð°Ñ‚ - Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ðº Ñ‡Ð°Ñ‚Ð°Ð¼ Ñ:', currentMatch.name);
                    
                    // Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ñ‡Ð°Ñ‚
                    setSelectedMatch(currentMatch);
                    console.log('âœ… Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ selectedMatch:', currentMatch.name);
                    
                    // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ðº Ñ‡Ð°Ñ‚Ð°Ð¼
                    setCurrentView('chats');
                    console.log('âœ… ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ðº chats view');
                    
                    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾
                    setShowFullScreenMatch(null);
                    
                    // ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ
                    nextProfile();
                    
                    console.log('âœ… ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ðº Ñ‡Ð°Ñ‚Ñƒ Ñ:', currentMatch.name);
                  }}
                  className="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white font-bold py-4 px-6 rounded-2xl hover:from-pink-600 hover:to-purple-700 transition-colors shadow-2xl"
                >
                  ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ‡Ð°Ñ‚
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

        {/* ÐœÐ¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ */}
        {deletingChat && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white p-6 rounded-lg max-w-sm mx-4">
            <h3 className="text-lg font-semibold text-gray-800 mb-3">Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‡Ð°Ñ‚?</h3>
            <p className="text-gray-600 mb-6">
              Ð’ÑÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ {matches.find(m => m.id === deletingChat)?.name || 'ÑÑ‚Ð¸Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼'} Ð±ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹. Ð­Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð½ÐµÐ»ÑŒÐ·Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ.
            </p>
            <div className="flex space-x-3">
              <button
                onClick={() => setDeletingChat(null)}
                className="flex-1 py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
              >
                ÐžÑ‚Ð¼ÐµÐ½Ð°
              </button>
              <button
                onClick={(e) => {
                  e.preventDefault();
                  e.stopPropagation();
                  
                  const matchIdToDelete = deletingChat; // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ID Ð¸Ð· ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
                  console.log('ðŸ—‘ï¸ ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‡Ð°Ñ‚Ð° Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°:', matchIdToDelete);
                  
                  // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¼Ð¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾
                  setDeletingChat(null);
                  
                  // Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ñ‡Ð°Ñ‚ Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ Ð´Ð»Ñ Ð¸Ð·Ð±ÐµÐ¶Ð°Ð½Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ð¾Ð²
                  setTimeout(() => {
                    deleteChat(matchIdToDelete);
                  }, 100);
                }}
                className="flex-1 py-2 px-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                disabled={!deletingChat} // Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ ÐºÐ»Ð¸ÐºÐ°
              >
                Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ
              </button>
            </div>
          </div>
        </div>
      )}
      </div>

      {/* ÐŸÐ ÐžÐ¤Ð˜Ð›Ð¬ Ð”Ð•Ð’Ð£Ð¨ÐšÐ˜ - Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð¼ Ð²Ð½Ðµ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð° */}
      {showProfileView && (
        <GirlProfileView 
          profile={showProfileView}
          onClose={() => {
            setShowProfileView(null);
            setProfilePhotoIndex(0);
            console.log('âŒ Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ¸');
          }}
        />
      )}

    </>
  );
};

        // âœ… ÐÐ°Ñ‡Ð¸Ð½Ð°Ð¹Ñ‚Ðµ Ñ:
        // Telegram WebApp API integration
        const getTelegramWebApp = () => {
          return window.Telegram?.WebApp;
        };

        // Ð’Ñ‹Ð½ÐµÑÐµÐ¼ ChatInput Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð·Ð° Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‹ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð°
        const ChatInput = React.memo(({ matchId, onSendMessage }) => {
          const [message, setMessage] = useState('');
          
          const handleSend = useCallback(() => {
            const messageText = message.trim();
            console.log('ðŸ”„ ChatInput handleSend:', { matchId, message: messageText });
            
            if (messageText) {
              console.log('âœ… ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ:', messageText);
              onSendMessage(matchId, messageText);
              setMessage('');
              console.log('ðŸ§¹ ÐžÑ‡Ð¸Ñ‰ÐµÐ½ input');
            } else {
              console.log('âŒ ÐŸÑƒÑÑ‚Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, Ð½Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼');
            }
          }, [matchId, message, onSendMessage]);

          // ... Ð’Ð•Ð¡Ð¬ ÐžÐ¡Ð¢ÐÐ›Ð¬ÐÐžÐ™ ÐšÐžÐ” Ð’ÐÐ¨ ÐšÐžÐ” ...

        // ðŸ‘‡ Ð’ Ð¡ÐÐœÐžÐœ ÐšÐžÐÐ¦Ð• Ð”ÐžÐ‘ÐÐ’Ð¬Ð¢Ð•:
        ReactDOM.render(<DatingApp />, document.getElementById('root'));
    </script>
</body>
</html>
